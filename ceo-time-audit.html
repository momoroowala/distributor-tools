<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEO Time Audit | What's Eating Your Week?</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--bg:#0a0a0f;--card:#12121a;--cell:#1a1a25;--border:#2a2a3a;--text:#f1f5f9;--muted:#94a3b8;--dim:#64748b}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;line-height:1.5}
        .container{max-width:960px;margin:0 auto;padding:1.5rem}
        header{text-align:center;margin-bottom:1.5rem;padding-top:1rem}
        .badge{display:inline-block;background:#f59e0b;color:#000;padding:0.2rem 0.6rem;border-radius:9999px;font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;margin-bottom:0.75rem}
        h1{font-size:2rem;font-weight:700;margin-bottom:0.5rem;background:linear-gradient(135deg,var(--text),#f59e0b);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .subtitle{color:var(--muted);font-size:1rem;max-width:500px;margin:0 auto}
        .section{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:1.5rem;margin-bottom:1.5rem}
        .section h2{font-size:1.1rem;margin-bottom:0.25rem}
        .section .hint{font-size:0.8rem;color:var(--dim);margin-bottom:1rem}
        /* Palette */
        .palette{display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem}
        .palette-item{display:flex;align-items:center;gap:0.4rem;padding:0.4rem 0.75rem;border-radius:0.5rem;cursor:pointer;border:2px solid transparent;font-size:0.75rem;font-weight:600;transition:all 0.15s;user-select:none}
        .palette-item:hover{transform:scale(1.03)}
        .palette-item.active{border-color:#fff;box-shadow:0 0 10px rgba(255,255,255,0.2)}
        .palette-item .dot{width:10px;height:10px;border-radius:3px;flex-shrink:0}
        /* Calendar Grid */
        .cal-wrapper{overflow-x:auto;margin-bottom:1rem}
        .cal{display:grid;grid-template-columns:60px repeat(5,1fr);gap:1px;background:var(--border);border-radius:0.5rem;overflow:hidden;user-select:none}
        .cal-header{background:#1e1e2e;padding:0.5rem;text-align:center;font-size:0.75rem;font-weight:600;color:var(--muted)}
        .cal-time{background:#1e1e2e;padding:0.35rem 0.5rem;font-size:0.7rem;color:var(--dim);display:flex;align-items:center}
        .cal-cell{background:var(--cell);padding:0.3rem;min-height:28px;cursor:pointer;transition:background 0.1s;position:relative;display:flex;align-items:center;justify-content:center;font-size:0.6rem;font-weight:600;color:rgba(255,255,255,0.8)}
        .cal-cell:hover{filter:brightness(1.3)}
        /* Stats Bar */
        .stats-bar{display:flex;gap:1rem;flex-wrap:wrap;margin-top:1rem}
        .stat{flex:1;min-width:120px;background:var(--cell);border-radius:0.5rem;padding:0.75rem;text-align:center}
        .stat .num{font-size:1.4rem;font-weight:700}
        .stat .label{font-size:0.7rem;color:var(--dim)}
        .time-bar{height:24px;border-radius:0.25rem;overflow:hidden;display:flex;margin-top:1rem}
        .time-bar .seg{display:flex;align-items:center;justify-content:center;font-size:0.65rem;font-weight:600;color:#fff;transition:width 0.3s}
        /* Ad Hoc Section */
        .adhoc-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:0.75rem}
        .adhoc-item{background:var(--cell);border-radius:0.5rem;padding:0.75rem}
        .adhoc-item label{display:block;font-size:0.85rem;margin-bottom:0.25rem}
        .adhoc-item .hint{font-size:0.7rem;color:var(--dim);margin-bottom:0.4rem}
        .adhoc-item input{width:100%;padding:0.5rem;background:var(--bg);border:1px solid var(--border);border-radius:0.35rem;color:var(--text);font-size:0.9rem}
        .adhoc-item input:focus{outline:none;border-color:#f59e0b}
        .btn{width:100%;padding:0.9rem;border-radius:0.5rem;font-weight:600;font-size:1rem;cursor:pointer;border:none;margin-top:1rem;transition:all 0.2s}
        .btn-primary{background:#f59e0b;color:#000}
        .btn-primary:hover{background:#fbbf24}
        /* Results */
        .results-page{display:none}.results-page.active{display:block;animation:fadeIn 0.4s ease}
        @keyframes fadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
        .impact-card{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:2rem;text-align:center;margin-bottom:1.5rem}
        .impact-number{font-size:3rem;font-weight:700;line-height:1}
        .impact-label{color:var(--dim);font-size:0.9rem;margin-top:0.25rem}
        .impact-context{color:var(--muted);margin-top:0.75rem;font-size:0.9rem}
        .reclaim-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:0.75rem;margin-top:1.25rem}
        .reclaim-item{background:var(--cell);border-radius:0.5rem;padding:1rem;text-align:center}
        .reclaim-item .number{font-size:1.3rem;font-weight:700;color:#22c55e}
        .reclaim-item .desc{font-size:0.7rem;color:var(--dim);margin-top:0.2rem}
        .before-after{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:1.5rem;margin-bottom:1.5rem}
        .before-after h3{font-size:1rem;margin-bottom:1rem}
        .ba-row{display:flex;gap:1rem}
        .ba-col{flex:1;background:var(--cell);border-radius:0.75rem;padding:1rem}
        .ba-col h4{font-size:0.8rem;text-transform:uppercase;letter-spacing:0.05em;margin-bottom:0.5rem}
        .ba-col.before h4{color:#ef4444}.ba-col.after h4{color:#22c55e}
        .ba-stat{display:flex;justify-content:space-between;padding:0.3rem 0;font-size:0.8rem;border-bottom:1px solid var(--border)}
        .ba-stat:last-child{border-bottom:none}
        .ba-stat .val{font-weight:600}
        .download-section{background:linear-gradient(135deg,rgba(245,158,11,0.1),var(--card));border:2px solid #f59e0b;border-radius:1rem;padding:2rem;text-align:center;margin-bottom:1.5rem}
        .download-section h3{font-size:1.3rem;margin-bottom:0.4rem}
        .download-section>p{color:var(--muted);margin-bottom:1.25rem;font-size:0.9rem}
        .email-form{display:flex;gap:0.75rem;max-width:420px;margin:0 auto;flex-wrap:wrap}
        .email-form input[type="email"]{flex:1;min-width:200px;padding:0.75rem;background:var(--bg);border:1px solid var(--border);border-radius:0.5rem;color:var(--text);font-size:0.95rem}
        .email-form input:focus{outline:none;border-color:#f59e0b}
        .email-form .btn{width:auto;min-width:160px;margin-top:0}
        .download-complete{display:none;color:#22c55e;padding:0.75rem;font-size:0.95rem}
        .download-complete.active{display:block}
        footer{text-align:center;padding:1.5rem;color:var(--dim);font-size:0.8rem}
        footer a{color:#f59e0b;text-decoration:none}
        @media(max-width:700px){.container{padding:1rem}h1{font-size:1.5rem}.reclaim-grid{grid-template-columns:repeat(2,1fr)}.adhoc-grid{grid-template-columns:1fr}.ba-row{flex-direction:column}.cal{font-size:0.6rem}}
    </style>
</head>
<body>
<div class="container">
    <header>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
        <span class="badge">Free Tool</span>
        <h1>What's Eating Your Week?</h1>
        <p class="subtitle">Paint your actual calendar. See what a machine should be doing instead of you.</p>
    </header>

    <div id="inputPage">
        <div class="section">
            <h2>Step 1: Paint Your Typical Week</h2>
            <p class="hint">Select a category below, then click or drag on the calendar to fill in your schedule. 9 AM to 9 PM, Monday through Friday.</p>

            <div class="palette" id="palette"></div>

            <div class="cal-wrapper">
                <div class="cal" id="calendar"></div>
            </div>

            <div class="time-bar" id="liveBar"></div>
            <div class="stats-bar" id="liveStats"></div>
        </div>

        <div class="section">
            <h2>Step 2: What Else Eats Your Time?</h2>
            <p class="hint">These tasks don't always show on a calendar but consume real hours every week.</p>
            <div class="adhoc-grid">
                <div class="adhoc-item"><label>Evening email/texts (after 9 PM)</label><div class="hint">Checking phone, responding to messages</div><input type="number" id="adhoc_evening" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
                <div class="adhoc-item"><label>Weekend work</label><div class="hint">Catching up, checking in, emergencies</div><input type="number" id="adhoc_weekend" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
                <div class="adhoc-item"><label>Unplanned interruptions</label><div class="hint">Walk-ins, surprise calls, "got a minute?"</div><input type="number" id="adhoc_interruptions" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
                <div class="adhoc-item"><label>Worrying/thinking about work</label><div class="hint">Laying in bed thinking about problems</div><input type="number" id="adhoc_worry" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
            </div>
        </div>

        <button class="btn btn-primary" onclick="analyze()">🔍 Analyze My Week</button>
    </div>

    <div class="results-page" id="resultsPage">
        <div class="impact-card">
            <div class="impact-number" style="color:#ef4444" id="automatableHours">0</div>
            <div class="impact-label">hours per week you spend on tasks a machine could handle</div>
            <div class="impact-context" id="impactContext"></div>
        </div>

        <div class="impact-card" style="border-color:#22c55e">
            <div class="impact-number" style="color:#22c55e" id="reclaimedDays">0</div>
            <div class="impact-label">work days per year you could reclaim</div>
            <div class="reclaim-grid" id="reclaimGrid"></div>
        </div>

        <div class="before-after">
            <h3>Your Week: Before vs After Automation</h3>
            <div class="ba-row">
                <div class="ba-col before" id="beforeCol"><h4>🔴 Now</h4></div>
                <div class="ba-col after" id="afterCol"><h4>🟢 After</h4></div>
            </div>
        </div>

        <div class="download-section">
            <h3>📄 Get Your Time Recovery Plan</h3>
            <p>Detailed PDF with automation recommendations for each time-waster and your "life reclaimed" projection.</p>
            <form class="email-form" id="emailForm" onsubmit="handleDownload(event)" style="flex-direction:column;align-items:stretch;max-width:420px;margin:0 auto;gap:0.5rem;">
                <div style="display:flex;gap:0.5rem;width:100%;">
                    <input type="text" id="userFirst" placeholder="First name" required style="flex:1;padding:0.75rem;background:var(--bg);border:1px solid var(--border);border-radius:0.5rem;color:var(--text);font-size:0.95rem;">
                    <input type="text" id="userLast" placeholder="Last name" required style="flex:1;padding:0.75rem;background:var(--bg);border:1px solid var(--border);border-radius:0.5rem;color:var(--text);font-size:0.95rem;">
                </div>
                <input type="email" id="userEmail" placeholder="Work email" required style="width:100%;padding:0.75rem;background:var(--bg);border:1px solid var(--border);border-radius:0.5rem;color:var(--text);font-size:0.95rem;">
                <button type="submit" class="btn btn-primary">Download PDF Report</button>
            </form>
            <div class="download-complete" id="downloadComplete">✓ Report downloaded!</div>
            
            <div style="margin-top:2rem;padding:1.5rem;background:var(--cell);border:1px solid var(--border);border-radius:1rem;text-align:center;max-width:420px;margin-left:auto;margin-right:auto;overflow:hidden;box-sizing:border-box;">
                <div style="font-size:0.7rem;text-transform:uppercase;letter-spacing:0.05em;color:#f59e0b;font-weight:600;margin-bottom:0.5rem;">Or skip straight to the expert</div>
                <h3 style="font-size:1.1rem;font-weight:700;margin-bottom:0.5rem;color:var(--text);">Get a Free Ops Walkthrough</h3>
                <p style="font-size:0.85rem;color:var(--muted);margin-bottom:0.75rem;line-height:1.5;padding:0 0.5rem;">Before any automation can work, your processes need to be right. Bad data in, bad results out. Talk to an automation expert this week and find out what's worth automating first.</p>
                <a href="https://calendly.com/mo-deeplineop/30min" target="_blank" rel="noopener" style="display:inline-block;padding:0.75rem 1.25rem;background:#f59e0b;color:#0a0a0f;font-weight:700;font-size:0.9rem;border-radius:0.5rem;text-decoration:none;transition:all 0.2s;max-width:100%;box-sizing:border-box;" onmouseover="this.style.opacity='0.85'" onmouseout="this.style.opacity='1'">Book 15 Min With an Expert →</a>
                <p style="font-size:0.75rem;color:var(--dim);margin-top:0.5rem;">Free. No pitch. Just a look at your operations.</p>
            </div>
        </div>
    </div>
    <footer><p>Built by <a href="#">Mo Roowala</a> | AI Automation for Distributors</p></footer>
</div>
<script>
const { jsPDF } = window.jspdf;

const categories = [
    { id:'strategy', name:'Strategy & Growth', short:'Strategy', color:'#22c55e', type:'strategic', save:0 },
    { id:'customers', name:'Customer Calls/Meetings', short:'Customers', color:'#06b6d4', type:'strategic', save:0 },
    { id:'pricing', name:'Pricing & Quotes', short:'Pricing', color:'#ef4444', type:'automatable', save:0.75 },
    { id:'orders', name:'Order Issues', short:'Orders', color:'#f97316', type:'automatable', save:0.65 },
    { id:'inventory', name:'Inventory/Purchasing', short:'Inventory', color:'#f43f5e', type:'automatable', save:0.6 },
    { id:'reports', name:'Reports & Data', short:'Reports', color:'#e11d48', type:'automatable', save:0.8 },
    { id:'admin', name:'Admin & Paperwork', short:'Admin', color:'#dc2626', type:'automatable', save:0.7 },
    { id:'fires', name:'Putting Out Fires', short:'Fires', color:'#b91c1c', type:'automatable', save:0.45 },
    { id:'email', name:'Email & Comms', short:'Email', color:'#eab308', type:'delegatable', save:0.35 },
    { id:'meetings', name:'Internal Meetings', short:'Meetings', color:'#a3a3a3', type:'delegatable', save:0.25 },
    { id:'people', name:'People Management', short:'People', color:'#8b5cf6', type:'delegatable', save:0.15 },
    { id:'break', name:'Break / Personal', short:'Break', color:'#374151', type:'neutral', save:0 }
];

const days = ['Mon','Tue','Wed','Thu','Fri'];
const hours = [];
for(let h=9;h<=20;h++) hours.push(h<12?h+'am':h===12?'12pm':(h-12)+'pm');

let selectedCat = 0;
let grid = {}; // key: "day-hour" -> categoryIndex
let isDragging = false;

function init() {
    // Palette
    const pal = document.getElementById('palette');
    pal.innerHTML = categories.map((c,i) => `
        <div class="palette-item ${i===0?'active':''}" onclick="selectCat(${i})" id="pal_${i}" style="background:${c.color}22">
            <div class="dot" style="background:${c.color}"></div>
            <span>${c.name}</span>
        </div>
    `).join('');

    // Calendar
    const cal = document.getElementById('calendar');
    let html = '<div class="cal-header"></div>';
    days.forEach(d => html += `<div class="cal-header">${d}</div>`);

    hours.forEach((h,hi) => {
        html += `<div class="cal-time">${h}</div>`;
        days.forEach((d,di) => {
            const key = `${di}-${hi}`;
            html += `<div class="cal-cell" id="c_${key}" data-key="${key}" 
                onmousedown="startPaint('${key}')" 
                onmouseenter="paint('${key}')"
                ontouchstart="startPaint('${key}')"
                ontouchmove="touchPaint(event)"></div>`;
        });
    });
    cal.innerHTML = html;
    document.addEventListener('mouseup', () => isDragging = false);
    document.addEventListener('touchend', () => isDragging = false);
    updateStats();
}

function selectCat(i) {
    selectedCat = i;
    document.querySelectorAll('.palette-item').forEach(p => p.classList.remove('active'));
    document.getElementById('pal_'+i).classList.add('active');
}

function startPaint(key) {
    isDragging = true;
    toggleCell(key);
}

function paint(key) {
    if(isDragging) toggleCell(key);
}

function touchPaint(e) {
    if(!isDragging) return;
    e.preventDefault();
    const touch = e.touches[0];
    const el = document.elementFromPoint(touch.clientX, touch.clientY);
    if(el && el.dataset && el.dataset.key) toggleCell(el.dataset.key);
}

function toggleCell(key) {
    const cell = document.getElementById('c_'+key);
    if(!cell) return;
    const cat = categories[selectedCat];
    if(grid[key] === selectedCat) {
        delete grid[key];
        cell.style.background = '';
        cell.textContent = '';
    } else {
        grid[key] = selectedCat;
        cell.style.background = cat.color + 'cc';
        cell.textContent = cat.short;
    }
    updateStats();
}

function updateStats() {
    const counts = {};
    categories.forEach((c,i) => counts[i] = 0);
    Object.values(grid).forEach(ci => counts[ci]++);

    const adhocEvening = parseFloat(document.getElementById('adhoc_evening')?.value) || 0;
    const adhocWeekend = parseFloat(document.getElementById('adhoc_weekend')?.value) || 0;
    const adhocInterruptions = parseFloat(document.getElementById('adhoc_interruptions')?.value) || 0;
    const adhocWorry = parseFloat(document.getElementById('adhoc_worry')?.value) || 0;
    const adhocTotal = adhocEvening + adhocWeekend + adhocInterruptions + adhocWorry;

    let strategic=0, delegatable=0, automatable=0, neutral=0;
    categories.forEach((c,i) => {
        if(c.type==='strategic') strategic += counts[i];
        else if(c.type==='delegatable') delegatable += counts[i];
        else if(c.type==='automatable') automatable += counts[i];
        else neutral += counts[i];
    });

    // Ad-hoc is mostly automatable/delegatable
    automatable += adhocInterruptions * 0.5;
    delegatable += adhocEvening + adhocWeekend + adhocInterruptions * 0.5 + adhocWorry;

    const total = strategic + delegatable + automatable + neutral + adhocTotal;

    // Live bar
    const bar = document.getElementById('liveBar');
    if(total > 0) {
        bar.innerHTML = `
            <div class="seg" style="width:${strategic/total*100}%;background:#22c55e">${strategic>0?strategic+'h':''}</div>
            <div class="seg" style="width:${delegatable/total*100}%;background:#eab308">${delegatable>0?Math.round(delegatable)+'h':''}</div>
            <div class="seg" style="width:${automatable/total*100}%;background:#ef4444">${automatable>0?Math.round(automatable)+'h':''}</div>
            <div class="seg" style="width:${neutral/total*100}%;background:#374151">${neutral>0?neutral+'h':''}</div>
        `;
    }

    // Live stats
    const calHours = Object.keys(grid).length;
    document.getElementById('liveStats').innerHTML = `
        <div class="stat"><div class="num">${calHours + adhocTotal}</div><div class="label">Total Hours</div></div>
        <div class="stat"><div class="num" style="color:#22c55e">${strategic}</div><div class="label">Strategic</div></div>
        <div class="stat"><div class="num" style="color:#eab308">${Math.round(delegatable)}</div><div class="label">Delegatable</div></div>
        <div class="stat"><div class="num" style="color:#ef4444">${Math.round(automatable)}</div><div class="label">Automatable</div></div>
    `;
}

function analyze() {
    const calHours = Object.keys(grid).length;
    const adhocEvening = parseFloat(document.getElementById('adhoc_evening').value) || 0;
    const adhocWeekend = parseFloat(document.getElementById('adhoc_weekend').value) || 0;
    const adhocInterruptions = parseFloat(document.getElementById('adhoc_interruptions').value) || 0;
    const adhocWorry = parseFloat(document.getElementById('adhoc_worry').value) || 0;

    if(calHours < 10) { alert('Please fill in more of your calendar (at least 10 hours).'); return; }

    // Count hours per category
    const catHours = {};
    categories.forEach((c,i) => catHours[i] = 0);
    Object.values(grid).forEach(ci => catHours[ci]++);

    // Build task breakdown
    let totalHrs = 0;
    let automatableHrs = 0;
    const breakdown = [];

    categories.forEach((c,i) => {
        let hrs = catHours[i] || 0;
        if(hrs === 0) return;
        const saved = hrs * c.save;
        automatableHrs += saved;
        totalHrs += hrs;
        breakdown.push({ ...c, hours: hrs, saved });
    });

    // Add ad hoc
    const adhocs = [
        { name:'Evening email/texts', hours:adhocEvening, save:0.6, type:'delegatable' },
        { name:'Weekend work', hours:adhocWeekend, save:0.4, type:'delegatable' },
        { name:'Unplanned interruptions', hours:adhocInterruptions, save:0.4, type:'automatable' },
        { name:'Worrying about work', hours:adhocWorry, save:0.3, type:'automatable' }
    ];
    adhocs.forEach(a => {
        if(a.hours > 0) {
            automatableHrs += a.hours * a.save;
            totalHrs += a.hours;
            breakdown.push({ name:a.name, hours:a.hours, saved:a.hours*a.save, type:a.type, color:'#6b7280' });
        }
    });

    // Show results
    document.getElementById('inputPage').style.display = 'none';
    document.getElementById('resultsPage').classList.add('active');

    document.getElementById('automatableHours').textContent = automatableHrs.toFixed(1);
    const yearlyHrs = Math.round(automatableHrs * 52);
    const yearlyDays = Math.round(yearlyHrs / 8);
    document.getElementById('reclaimedDays').textContent = yearlyDays;

    const pctAutomate = ((automatableHrs / totalHrs) * 100).toFixed(0);
    document.getElementById('impactContext').innerHTML = `<strong>${pctAutomate}%</strong> of your ${totalHrs}-hour work week is spent on tasks that don't need you. That's <strong>${yearlyHrs.toLocaleString()} hours per year</strong>.`;

    const dinners = Math.min(Math.round((automatableHrs / 3) * 52), 104);
    const vacWeeks = (yearlyDays / 5).toFixed(1);
    const events = Math.min(Math.round((automatableHrs / 5) * 40), 40);
    const dollarImpact = Math.round((automatableHrs / totalHrs) * 250000);
    document.getElementById('reclaimGrid').innerHTML = `
        <div class="reclaim-item"><div class="number">${dinners}</div><div class="desc">Family dinners</div></div>
        <div class="reclaim-item"><div class="number">${vacWeeks}</div><div class="desc">Weeks reclaimed</div></div>
        <div class="reclaim-item"><div class="number">${events}</div><div class="desc">Kids' events</div></div>
        <div class="reclaim-item"><div class="number">$${dollarImpact.toLocaleString()}</div><div class="desc">CEO time cost</div></div>
    `;

    // Before/After
    const bCol = document.getElementById('beforeCol');
    const aCol = document.getElementById('afterCol');
    bCol.innerHTML = '<h4>🔴 Now</h4>';
    aCol.innerHTML = '<h4>🟢 After</h4>';
    breakdown.sort((a,b) => b.hours - a.hours).forEach(t => {
        bCol.innerHTML += `<div class="ba-stat"><span>${t.name}</span><span class="val">${t.hours}h</span></div>`;
        const after = (t.hours - t.saved).toFixed(1);
        aCol.innerHTML += `<div class="ba-stat"><span>${t.name}</span><span class="val" style="color:${t.saved>0?'#22c55e':'inherit'}">${after}h</span></div>`;
    });
    bCol.innerHTML += `<div class="ba-stat" style="border-top:2px solid var(--border);margin-top:0.4rem;padding-top:0.4rem"><span><strong>Total</strong></span><span class="val">${totalHrs}h</span></div>`;
    aCol.innerHTML += `<div class="ba-stat" style="border-top:2px solid var(--border);margin-top:0.4rem;padding-top:0.4rem"><span><strong>Total</strong></span><span class="val" style="color:#22c55e">${(totalHrs - automatableHrs).toFixed(1)}h</span></div>`;

    window._data = { totalHrs, automatableHrs, yearlyHrs, yearlyDays, breakdown, dinners, vacWeeks, events, dollarImpact };
}

function handleDownload(e) {
    e.preventDefault();
    const firstName = document.getElementById('userFirst').value.trim();
    const lastName = document.getElementById('userLast').value.trim();
    const email = document.getElementById('userEmail').value.trim();
    if(!firstName||!lastName||!email) return;
    fetch('https://script.google.com/macros/s/AKfycbxH-0F_yuJve8Bvzf1WWqYc5Z0ptXRRktVCmLEEa-7Dbs3ear7cNESr6-Bmm8mQIJaZ/exec',{method:'POST',headers:{'Content-Type':'text/plain'},body:JSON.stringify({name:firstName+' '+lastName,email:email,tool:'CEO Time Audit',_subject:'New Lead: '+firstName+' '+lastName+' - CEO Time Audit',message:firstName+' '+lastName+' ('+email+') completed the CEO Time Audit and downloaded their PDF report.'})}).catch(function(){});
    const leads = JSON.parse(localStorage.getItem('timeaudit_leads') || '[]');
    leads.push({ email, timestamp: new Date().toISOString(), data: window._data });
    localStorage.setItem('timeaudit_leads', JSON.stringify(leads));
    generatePDF(email);
    document.getElementById('emailForm').style.display = 'none';
    document.getElementById('downloadComplete').classList.add('active');
}

function generatePDF(email) {
    const firstName = document.getElementById('userFirst').value.trim();
    const lastName = document.getElementById('userLast').value.trim();
    const userName = firstName + ' ' + lastName;
    
    const d = window._data;
    const doc = new jsPDF();
    const pw = doc.internal.pageSize.getWidth();
    const ph = doc.internal.pageSize.getHeight();
    const m = 20, cw = pw - 2*m;
    let y = 0;
    let pageNum = 0;

    // Design system - Material Design
    const C = {
        bg: [15, 15, 20],           // Dark background
        card: [25, 25, 35],         // Dark card
        cell: [35, 35, 45],         // Slightly lighter for nested elements
        border: [50, 50, 65],       // Subtle border
        text: [241, 245, 249],      // Light text
        textMid: [148, 163, 184],   // Muted text
        textLight: [100, 116, 139], // Dimmer text
        white: [255, 255, 255],
        shadow: [10, 10, 15],       // Dark shadow
        blue: [96, 165, 250],       // Brighter blue for dark bg
        red: [248, 113, 113],       // Brighter red
        yellow: [251, 191, 36],
        green: [74, 222, 128],      // Brighter green
        purple: [192, 132, 252],    // Brighter purple
        amber: [251, 191, 36]
    };

    const txt = (t,sz,st='normal',c=C.text) => { doc.setFontSize(sz); doc.setFont('helvetica',st); doc.setTextColor(...c); };
    const fill = (c) => doc.setFillColor(...c);
    const stroke = (c) => doc.setDrawColor(...c);

    // Dynamic text fitting helper
    const fitText = (doc, text, maxWidth, startSize, minSize = 7.5) => {
        let sz = startSize;
        let lines;
        while (sz >= minSize) {
            doc.setFontSize(sz);
            lines = doc.splitTextToSize(text, maxWidth);
            if (lines.length <= 3) break;
            sz -= 0.5;
        }
        return { lines, fontSize: sz };
    };

    // Measure text height precisely
    const measureText = (text, fontSize, maxWidth) => {
        doc.setFontSize(fontSize);
        const lines = doc.splitTextToSize(text, maxWidth);
        return lines.length * (fontSize * 0.4);
    };
    
    // Dynamic page break checking with actual content height
    const cp = (contentHeight) => { 
        if (y + contentHeight > 265) {
            newPage(); 
            return true;
        } 
        return false; 
    };

    const newPage = () => {
        doc.addPage(); pageNum++;
        fill(C.bg); doc.rect(0,0,pw,ph,'F');
        fill(C.amber); doc.rect(0,0,pw,1.5,'F');
        y = 20;
    };

    // Dynamic card with measured content height
    const dynamicCard = (x, yPos, w, content, opts = {}) => {
        // First pass: measure all content to get exact height
        let totalContentHeight = 0;
        let measuredContent = [];

        content.forEach(item => {
            let itemHeight = 0;
            if (item.type === 'title') {
                const fitted = fitText(doc, item.text, item.maxWidth || w - 20, item.fontSize || 9, 7);
                itemHeight = fitted.lines.length * (fitted.fontSize * 0.55) + 3;
                measuredContent.push({...item, fitted, height: itemHeight});
            } else if (item.type === 'text') {
                const fitted = fitText(doc, item.text, item.maxWidth || w - 20, item.fontSize || 9, 7);
                itemHeight = fitted.lines.length * (fitted.fontSize * 0.55) + 3;
                measuredContent.push({...item, fitted, height: itemHeight});
            } else if (item.type === 'bullet') {
                const fitted = fitText(doc, item.text, item.maxWidth || w - 30, item.fontSize || 8, 7);
                itemHeight = fitted.lines.length * (fitted.fontSize * 0.55) + 2;
                measuredContent.push({...item, fitted, height: itemHeight});
            } else if (item.type === 'metric') {
                itemHeight = (item.fontSize || 16) * 0.4 + 8;
                measuredContent.push({...item, height: itemHeight});
            } else if (item.type === 'space') {
                itemHeight = item.height;
                measuredContent.push({...item, height: itemHeight});
            } else if (item.type === 'chart') {
                itemHeight = item.height || 30;
                measuredContent.push({...item, height: itemHeight});
            }
            totalContentHeight += itemHeight;
        });

        const cardHeight = totalContentHeight + 20; // 10px top + 10px bottom padding

        // Check page break with actual calculated height
        if (yPos + cardHeight > 265) {
            newPage();
            yPos = y;
        }
        // Sync outer y so callers start from correct position after page break
        y = yPos;

        // Draw card background
        const r = opts.radius || 2;
        fill(C.shadow); doc.roundedRect(x+0.5, yPos+0.5, w, cardHeight, r, r, 'F');
        stroke(C.border); doc.setLineWidth(0.2);
        fill(C.card); doc.roundedRect(x, yPos, w, cardHeight, r, r, 'FD');
        if(opts.accent) { 
            fill(opts.accent); 
            doc.roundedRect(x, yPos, 3, cardHeight, r, 0, 'F'); 
            doc.rect(x+1.5, yPos, 1.5, cardHeight, 'F'); 
        }

        // Render content with measured positions
        let currentY = yPos + 10;
        measuredContent.forEach(item => {
            const lh = item.fitted ? item.fitted.fontSize * 0.55 : 0;
            if (item.type === 'title' || item.type === 'text') {
                txt(item.text, item.fitted.fontSize, item.type === 'title' ? (item.style || 'bold') : (item.style || 'normal'), item.color || C.text);
                if (item.align === 'center') {
                    item.fitted.lines.forEach((line, li) => {
                        doc.text(line, x + w/2, currentY + item.fitted.fontSize * 0.35 + li * lh, {align: 'center'});
                    });
                } else {
                    item.fitted.lines.forEach((line, li) => {
                        doc.text(line, x + 10, currentY + item.fitted.fontSize * 0.35 + li * lh);
                    });
                }
            } else if (item.type === 'bullet') {
                fill(item.bulletColor || C.blue);
                doc.circle(x + 12, currentY + 2, 1, 'F');
                txt(item.text, item.fitted.fontSize, item.style || 'normal', item.color || C.text);
                item.fitted.lines.forEach((line, li) => {
                    doc.text(line, x + 16, currentY + item.fitted.fontSize * 0.35 + li * lh);
                });
            } else if (item.type === 'metric') {
                txt(item.text, item.fontSize || 16, item.style || 'bold', item.color || C.text);
                if (item.align === 'center') {
                    doc.text(item.text, x + w/2, currentY + (item.fontSize || 16) * 0.3, {align: 'center'});
                } else {
                    doc.text(item.text, x + 10, currentY + (item.fontSize || 16) * 0.3);
                }
            } else if (item.type === 'chart') {
                if (item.circleData) {
                    item.circleData.forEach(circle => {
                        fill(circle.color);
                        doc.circle(x + circle.x, currentY + circle.y, circle.radius, 'F');
                        if (circle.text) {
                            txt(circle.text, circle.fontSize || 12, circle.style || 'bold', circle.textColor || C.white);
                            doc.text(circle.text, x + circle.x, currentY + circle.y + 2, {align: 'center'});
                        }
                    });
                }
                if (item.barData) {
                    item.barData.forEach(bar => {
                        fill(bar.color);
                        doc.roundedRect(x + bar.x, currentY + bar.y, bar.width, bar.height, 1, 1, 'F');
                    });
                }
            }
            currentY += item.height;
        });

        return cardHeight;
    };

    // Section header with dynamic height
    const secTitle = (title, yy, color = C.amber) => {
        const titleHeight = measureText(title, 12, cw - 30) + 18;
        cp(titleHeight);
        
        txt(title, 12, 'bold', C.text); 
        doc.text(title, m, yy + 7);
        fill(color); 
        doc.rect(m, yy + 10, 25, 1.5, 'F');
        return yy + titleHeight;
    };

    const totalHrs = d.breakdown.reduce((s,t) => s+t.hours,0);
    const strategicHrs = d.breakdown.filter(t=>t.type==='strategic').reduce((s,t)=>s+t.hours,0);
    const automatablePct = totalHrs > 0 ? Math.round((d.automatableHrs/totalHrs)*100) : 0;
    const strategicPct = Math.max(0, 100 - automatablePct);
    const afterTotal = totalHrs - d.automatableHrs;
    const sorted = [...d.breakdown].filter(t=>t.hours>0).sort((a,b)=>b.saved-a.saved);
    const maxHrs = Math.max(...sorted.map(t=>t.hours));
    const dollarImpact = d.dollarImpact || 0;

    // =============================
    // PAGE 1: COVER
    // =============================
    fill(C.bg); doc.rect(0,0,pw,ph,'F');

    // Hero Section - Fixed layout for cover
    fill(C.card); stroke(C.border); doc.roundedRect(0,-10,pw,72,0,0,'FD');
    fill(C.amber); doc.circle(pw/2,16,7,'F');
    txt('A',11,'bold',C.white); doc.text('A',pw/2,19,{align:'center'});

    txt('CEO TIME AUDIT',20,'bold',C.text); doc.text('CEO TIME AUDIT',pw/2,36,{align:'center'});
    txt('Your Personalized Time Recovery Analysis',10,'normal',C.textMid); doc.text('Your Personalized Time Recovery Analysis',pw/2,46,{align:'center'});

    if (userName) {
        txt('Prepared for: ' + userName,9,'bold',C.amber);
        doc.text('Prepared for: ' + userName, pw/2, 52, {align:'center'});
    }

    fill(C.bg); doc.roundedRect(pw/2-50,54,100,8,4,4,'F');
    txt(new Date().toLocaleDateString('en-US',{month:'long',day:'numeric',year:'numeric'}),8,'bold',C.textMid);
    doc.text(new Date().toLocaleDateString('en-US',{month:'long',day:'numeric',year:'numeric'}),pw/2,59.5,{align:'center'});

    y = 80;

    // Key metrics row - Dynamic
    const metricW = (cw-10)/3;
    const mets = [
        { val: d.automatableHrs.toFixed(1)+'h', label:'RECOVERABLE', sub:'per week', color:C.red },
        { val: d.yearlyDays.toString(), label:'WORK DAYS/YEAR', sub:'returned', color:C.amber },
        { val: d.dinners.toString(), label:'DINNERS', sub:'reclaimed', color:C.green }
    ];
    mets.forEach((mt,i) => {
        const x = m + i*(metricW+5);
        const metricContent = [
            { type: 'metric', text: mt.val, fontSize: 18, style: 'bold', color: mt.color, align: 'center' },
            { type: 'text', text: mt.label, fontSize: 8, style: 'bold', color: C.text, align: 'center' },
            { type: 'text', text: mt.sub, fontSize: 7, color: C.textLight, align: 'center' },
            { type: 'space', height: 8 }
        ];
        dynamicCard(x, y, metricW, metricContent, {accent:mt.color});
    });
    y += measureText('Test', 18, metricW) + 32;

    // Summary Card - Dynamic
    const summaryContent = [
        { type: 'title', text: 'EXECUTIVE SUMMARY', fontSize: 9, style: 'bold', color: C.amber },
        { type: 'space', height: 4 },
        { type: 'text', text: `You reported ${totalHrs} hours/week across ${d.breakdown.filter(t=>t.hours>0).length} task categories. The typical distribution owner works 50+ hours per week, with only 30% going to planning and strategy (Prosperity for America, 2025). Your audit tells us exactly where your time leaks are.`, fontSize: 9.5, maxWidth: cw-20 },
        { type: 'space', height: 3 },
        { type: 'text', text: `${d.automatableHrs.toFixed(1)} hours per week (${Math.round(d.automatableHrs/totalHrs*100)}%) can be automated or delegated. That is ${d.yearlyHrs.toLocaleString()} hours per year, or ${d.yearlyDays} full work days you are currently spending on tasks that do not require your expertise.`, fontSize: 9.5, maxWidth: cw-20 },
        { type: 'space', height: 3 },
        { type: 'text', text: `Current state: only ${strategicPct}% of your time goes to high-leverage strategic work. Research shows CEOs who shift to 40-50% strategic time and delegate effectively generate 33% more revenue (Gallup). This report shows you exactly how to close that gap over the next 90 days.`, fontSize: 9.5, maxWidth: cw-20 },
        { type: 'space', height: 8 }
    ];
    const summaryHeight = dynamicCard(m, y, cw, summaryContent);
    y += summaryHeight + 8;

    // What's In This Report - Dynamic
    const reportContent = [
        { type: 'title', text: "WHAT'S IN THIS REPORT", fontSize: 8, style: 'bold', color: C.amber },
        { type: 'space', height: 4 },
        { type: 'bullet', text: 'Time Allocation Analysis: Where your hours actually go vs. where they should go', fontSize: 8, bulletColor: C.blue },
        { type: 'bullet', text: 'Industry Benchmarks: How your time allocation compares to top-performing distribution CEOs', fontSize: 8, bulletColor: C.blue },
        { type: 'bullet', text: 'Automation Playbook: Specific, step-by-step fixes for your top time drains with expected savings', fontSize: 8, bulletColor: C.blue },
        { type: 'bullet', text: '90-Day Time Recovery Roadmap: Phased implementation with deliverables, hour targets, and dollar values', fontSize: 8, bulletColor: C.blue },
        { type: 'space', height: 8 }
    ];
    const reportHeight = dynamicCard(m, y, cw, reportContent);
    y += reportHeight + 8;

    // Dollar Impact callout - Dynamic
    if(dollarImpact > 0) {
        const dollarContent = [
            { type: 'title', text: 'DOLLAR IMPACT', fontSize: 8, style: 'bold', color: C.red },
            { type: 'space', height: 2 },
            { type: 'text', text: `Your wasted time costs an estimated $${dollarImpact.toLocaleString()} per year in CEO opportunity cost.`, fontSize: 10, style: 'bold', maxWidth: cw-20 },
            { type: 'space', height: 8 }
        ];
        const dollarHeight = dynamicCard(m, y, cw, dollarContent, {accent:C.red});
        y += dollarHeight + 8;
    }

    // =============================
    // PAGE 2: ANALYSIS
    // =============================
    newPage();
    y = secTitle('TIME ALLOCATION ANALYSIS', y);

    // Task breakdown chart - Dynamic
    const taskContent = [
        { type: 'space', height: 4 }
    ];
    
    sorted.forEach((t) => {
        const typeCol = t.type==='strategic'?C.green:t.type==='delegatable'?C.amber:C.red;
        taskContent.push({
            type: 'bullet',
            text: `${t.name}: ${t.hours}h${t.saved>0 ? ` (-${t.saved.toFixed(1)})` : ''}`,
            fontSize: 9,
            bulletColor: typeCol,
            style: 'bold'
        });
    });
    taskContent.push({ type: 'space', height: 8 });
    
    const taskHeight = dynamicCard(m, y, cw, taskContent);
    y += taskHeight + 8;

    // Breakdown side-by-side - Dynamic
    const hw = (cw-6)/2;
    
    const categoriesContent = [
        { type: 'title', text: 'TIME BY CATEGORY', fontSize: 8, style: 'bold', color: C.textMid },
        { type: 'space', height: 6 }
    ];
    
    const cats = [
        { label:'Strategic', color:C.green, hrs: d.breakdown.filter(t=>t.type==='strategic').reduce((s,t)=>s+t.hours,0) },
        { label:'Delegatable', color:C.amber, hrs: d.breakdown.filter(t=>t.type==='delegatable').reduce((s,t)=>s+t.hours,0) },
        { label:'Automatable', color:C.red, hrs: d.breakdown.filter(t=>t.type==='automatable').reduce((s,t)=>s+t.hours,0) }
    ];
    
    cats.forEach(c => {
        if(c.hrs > 0) {
            const p = Math.round(c.hrs/totalHrs*100);
            categoriesContent.push({
                type: 'bullet',
                text: `${c.label}: ${c.hrs}h (${p}%)`,
                fontSize: 9,
                bulletColor: c.color
            });
        }
    });
    categoriesContent.push({ type: 'space', height: 8 });

    const impactContent = [
        { type: 'title', text: 'WEEKLY IMPACT', fontSize: 8, style: 'bold', color: C.textMid },
        { type: 'space', height: 6 },
        { type: 'chart', height: 30, 
            circleData: [
                { x: hw/2-20, y: 15, radius: 12, color: C.red, text: totalHrs.toString(), fontSize: 14, textColor: C.white },
                { x: hw/2+20, y: 15, radius: 12, color: C.green, text: afterTotal.toFixed(0), fontSize: 14, textColor: C.white }
            ]
        },
        { type: 'text', text: 'NOW                            GOAL', fontSize: 7, style: 'bold', color: C.textMid, align: 'center' },
        { type: 'space', height: 8 }
    ];

    const categoriesHeight = dynamicCard(m, y, hw, categoriesContent);
    const impactHeight = dynamicCard(m+hw+6, y, hw, impactContent);
    y += Math.max(categoriesHeight, impactHeight) + 8;

    // =============================
    // PAGE 3: INDUSTRY BENCHMARKS
    // =============================
    newPage();
    y = secTitle('HOW YOU COMPARE: INDUSTRY BENCHMARKS', y);

    const benchmarks = [
        { stat: '70%', desc: 'of a typical business owner\'s workweek is spent on operational duties, leaving only 30% for planning and strategy.', source: 'Prosperity for America, 2025' },
        { stat: '33%', desc: 'more revenue is generated by CEOs who excel at delegation compared to those who try to do everything themselves.', source: 'Gallup' },
        { stat: '23 min', desc: 'is the refocus cost after every interruption. Workers are interrupted every 3 minutes on average, creating a cycle of fragmented attention that destroys deep work.', source: 'University of California, Irvine' },
        { stat: '11%', desc: 'of meetings are considered productive. The other 89% cost US businesses $37 billion per year in wasted salary costs.', source: 'Atlassian' },
        { stat: '28%', desc: 'of the average workweek is consumed by email alone, roughly 11 hours. For distribution owners fielding pricing, order, and vendor emails, the number is often higher.', source: 'McKinsey' },
        { stat: '75-100', desc: 'basis points of EBIT improvement is achievable for wholesale distributors through AI and process automation, according to Deloitte analysis.', source: 'Deloitte, 2024' }
    ];

    benchmarks.forEach((b, idx) => {
        const isYours = (idx === 0 && strategicPct < 35) || (idx === 3 && d.breakdown.some(t => t.id === 'meetings' && t.hours > 5));
        const benchContent = [
            { type: 'metric', text: b.stat, fontSize: 16, style: 'bold', color: C.amber, align: 'center' },
            { type: 'text', text: b.desc, fontSize: 8.5, color: C.text, maxWidth: cw - 30 },
            { type: 'text', text: 'Source: ' + b.source, fontSize: 7, style: 'italic', color: C.textLight, maxWidth: cw - 30 },
            { type: 'space', height: 6 }
        ];
        if (isYours) {
            benchContent.splice(1, 0, { type: 'text', text: '^ Your audit suggests you are in this category.', fontSize: 7, style: 'bold', color: C.red });
        }
        const bh = dynamicCard(m, y, cw, benchContent, { accent: C.amber });
        y += bh + 5;
    });

    // Your position summary
    const posContent = [
        { type: 'title', text: 'YOUR POSITION', fontSize: 9, style: 'bold', color: C.blue },
        { type: 'space', height: 4 },
        { type: 'bullet', text: `You spend ${strategicPct}% of your time on strategic work. Top-performing CEOs spend 40-50%. Gap: ${Math.max(0, 40 - strategicPct)} percentage points.`, fontSize: 8.5, bulletColor: strategicPct >= 35 ? C.green : C.red },
        { type: 'bullet', text: `You work ${totalHrs} hours per week. 63% of business owners work 50+ hours. The goal is not fewer hours; it is better hours.`, fontSize: 8.5, bulletColor: totalHrs > 50 ? C.red : C.green },
        { type: 'bullet', text: `${Math.round(d.automatableHrs/totalHrs*100)}% of your week is automatable or delegatable. Industry average is 40-60%. Every percentage point you recover compounds over 52 weeks.`, fontSize: 8.5, bulletColor: C.amber },
        { type: 'space', height: 8 }
    ];
    const posH = dynamicCard(m, y, cw, posContent, { accent: C.blue });
    y += posH + 8;

    // =============================
    // PAGE 4: PLAYBOOK
    // =============================
    newPage();
    y = secTitle('AUTOMATION PLAYBOOK', y);

    const guides = {
        'Pricing & Quotes': { solution:'Rule-based pricing engine with rep-facing cheat sheets', impact:'78% of competitive quotes go to the fastest responder. The average distributor loses 3-5 deals per week to slower quote turnaround (Distribution Strategy Group, 2024). Quote automation cuts response time from hours to minutes.', steps:['Export last 90 days of quotes to CSV. Tag each as Standard (repeat customer, catalog SKU, normal volume) or Custom. You will likely find 70-80% are Standard and fully automatable.','Pull your top 50 SKUs by volume. Set floor prices at cost + 18%. Create a one-page "pricing cheat sheet" with tiers: 1-10 units, 11-50, 51+. Give this to every rep. They stop calling you for pricing on 80% of orders.','Build automated approval workflows: Standard quotes auto-generate and send. Custom quotes route to you only if the deal exceeds $10K or margin drops below 15%. This saves 4-5 hours per week for most owners.','Track quote response time weekly. Your target: under 30 minutes for Standard, under 4 hours for Custom. Post the numbers where your team can see them. What gets measured gets managed.'] },
        'Order Issues': { solution:'Order validation rules and customer self-service portal', impact:'SMBs spend 23% of their workdays on manual data entry (Prosperity for America, 2025). Each order error costs roughly 10x the original entry time to fix when you factor in calls, credits, reshipping, and customer frustration.', steps:['Pull your top 10 order error types from the last quarter. Common ones: wrong SKU, wrong ship-to, duplicate order, credit hold. Rank them by frequency. The top 3 types likely account for 70% of all errors.','Build validation rules at the point of entry: SKU verification against active catalog, credit limit check before processing, address validation against shipping database. Each rule you add eliminates an entire category of errors permanently.','Launch a customer self-service portal for order tracking and proof of delivery. "Where is my order?" calls typically consume 3-6 hours per week for distribution owners. A portal with real-time tracking cuts these calls by 60-80%.','Automate order confirmations and shipping notifications via email and text. Zero manual follow-up. Customers get updates at order received, shipped, and delivered. This alone eliminates 15-20 inbound calls per day for a mid-size distributor.'] },
        'Inventory/Purchasing': { solution:'Demand forecasting with automated reorder points', impact:'Poor forecasting is the top operational challenge for distributors (McKinsey, 2023). Carrying excess inventory ties up 20-30% more working capital than necessary, while stockouts cost distributors an estimated 4% of annual revenue in lost sales.', steps:['Run ABC analysis on all SKUs. A-items (top 20% by revenue) get weekly review and tight reorder points. B-items get biweekly review. C-items get monthly review with higher safety stock. This alone reduces stockouts on critical items by 35-50%.','Set automated reorder points based on 2+ years of sales velocity, adjusted for seasonality. Formula: (Average Daily Sales x Lead Time) + Safety Stock. Automate the PO generation so it triggers without you reviewing every purchase.','Identify dead stock: pull every SKU with zero movement in the last 12 months. Create a 90-day clearance plan: Week 1-4 at 20% off, Week 5-8 at 40% off, Week 9-12 donate or scrap. Free up warehouse space and cash.','Replace annual physical inventory with cycle counting. Count 5-10% of SKUs daily on a rotating basis. By month 3, you have covered every item and your accuracy stays above 98% year-round. No more weekend shutdowns for full counts.'] },
        'Reports & Data': { solution:'Automated dashboards that replace manual reporting entirely', impact:'The typical employee spends 51% of each workday on tasks with little to no value, and manual reporting is one of the biggest culprits (Prosperity for America, 2025). Employees save 5-10 hours weekly when reporting is automated (CRM.org, 2024).', steps:['List every recurring report you or your team produce. If it involves opening your ERP, exporting to Excel, reformatting, and emailing, that report is automatable. Most distribution owners find 6-10 reports that fit this description.','Build a single executive dashboard with your top 5 KPIs: revenue vs. target, gross margin by category, fill rate, AR aging, and inventory turns. Set it to auto-refresh daily. Check it once each morning for 5 minutes instead of spending 2 hours compiling data.','Schedule automated email delivery of every recurring report. Sales gets their pipeline report Monday morning. Ops gets the fulfillment scorecard Tuesday. Finance gets AR aging Wednesday. Nobody "pulls" data manually.','Kill any report nobody has acted on in 30 days. Ask the recipients: "If this report stopped arriving, would you notice within a week?" If the answer is no, stop producing it. Less noise means better signal on the reports that actually matter.'] },
        'Admin & Paperwork': { solution:'Digital approval workflows with tiered authority levels', impact:'Businesses spend up to 16 days per year searching for paper documents (Prosperity for America, 2025). Every manual approval you touch costs your company $50-150 in CEO time for a task that often takes someone else 5 minutes.', steps:['Map every approval chain end to end. Count how many approvals you personally touch per week. Any approval under $500 should auto-approve with a notification copy to you. You review the log once daily instead of approving each one live. This alone saves 3-5 hours per week for most distribution owners.','Implement e-signatures for all contracts, POs, and vendor agreements. No more printing, wet-signing, scanning, and emailing. A $20/month e-signature tool saves 30-60 minutes per day and eliminates the "waiting for signature" bottleneck.','Set tiered authority levels: warehouse leads approve receiving discrepancies under $200, branch managers handle customer credits under $1,000, you handle only strategic decisions and exceptions above those thresholds. Document these levels in a one-page authority matrix.','Automate AP/AR workflows. Invoice matching (PO to receipt to invoice) should be automatic. Payment reminders should send at 30, 45, and 60 days without human involvement. Collections escalation to you only at 90+ days or above $5,000.'] },
        'Putting Out Fires': { solution:'Early warning systems with written response playbooks', impact:'CEOs spend 36% of their time in reactive mode, handling issues as they unfold (Forbes/Fast Company, 2024). Most "fires" are actually recurring patterns disguised as emergencies. Fix the pattern, and the fires stop.', steps:['Log every fire for 5 business days. Use a simple spreadsheet: date, description, root cause, time spent, who escalated it. After 5 days, categorize them. You will find 3-4 patterns that account for 70-80% of all escalations.','Write a one-page response playbook for your top 3 recurring fire types. Example: "Customer threatens to leave over a late shipment: 1) Apologize sincerely. 2) Offer expedited reshipping at our cost if order is over $500. 3) Issue a 5% credit on the next order. 4) Escalate to owner only if customer revenue exceeds $50K/year."','Set up proactive alerts that catch problems before they escalate: inventory below safety stock, shipments not scanned by 2 PM, credit holds on orders from your top 50 accounts. Each alert you build eliminates a future fire.','Empower team leads to resolve without escalating. Post the playbooks visibly. When someone escalates something covered by a playbook, redirect them to the playbook instead of solving it yourself. This is how you train the behavior.'] },
        'Email & Comms': { solution:'Batch processing, canned responses, and inbox delegation', impact:'Workers are interrupted every 3 minutes and 5 seconds on average, and each interruption costs 23 minutes and 15 seconds of refocus time (UC Irvine). The average professional spends 28% of their workweek on email alone, roughly 11 hours (McKinsey). For a distribution owner, that is 11 hours not spent on growth.', steps:['Implement batch processing: check email 3 times daily at fixed times (8 AM, 12 PM, 4 PM). Close your email client between those windows. This single change recovers 1-2 hours per day by eliminating constant context switching. The 23-minute refocus cost per interruption means every email check during deep work costs you nearly half an hour.','Create canned responses for your top 10 recurring questions. Common ones: pricing requests, lead time inquiries, return policy, credit application status, delivery ETA. One click instead of 10 minutes of typing. Save them as templates in your email client.','Route all system notifications (ERP alerts, shipping confirmations, vendor updates) to a separate folder. Review it once daily at 4 PM. These notifications feel urgent but almost never are. Separating them reduces your primary inbox volume by 30-50%.','Delegate routine email replies to your ops manager or assistant. Create a shared inbox or forwarding rule for: order status questions, simple pricing inquiries, vendor scheduling, and routine customer requests. You handle only emails from your top 20 accounts, strategic partnerships, and financial matters.'] },
        'Internal Meetings': { solution:'Async-first communication with dashboards replacing status updates', impact:'Only 11% of meetings are considered productive (Atlassian). Professionals waste 31 hours per month in unproductive meetings (TeamStage, 2024). Unnecessary meetings cost US businesses $37 billion per year in salary costs alone. Every meeting you eliminate gives your entire team their time back, not just you.', steps:['Audit every recurring meeting on your calendar. For each one, ask: "What decision does this meeting produce?" If the answer is "awareness" or "status update," cancel it immediately. Replace it with a shared dashboard or a 3-bullet async update in Slack or email. Most distribution owners find they can cut 40-60% of recurring meetings this way.','Replace all status update meetings with a shared dashboard. Sales pipeline, order fulfillment, AR aging, inventory levels: these are numbers on a screen, not topics for a room. Post the dashboard link where everyone can access it. Update it automatically from your systems.','Enforce 25-minute meeting defaults (not 30 or 60). Require a written agenda sent 24 hours before the meeting. If no agenda arrives, the meeting is automatically canceled. This rule alone kills 30% of unnecessary meetings because people realize they do not actually need one.','Every meeting must end with written next steps, owners, and deadlines posted in a shared document within 10 minutes of the meeting ending. If a meeting does not produce clear action items, it should not have been a meeting. Review your meeting output monthly and cut any recurring meeting that consistently produces no actions.'] },
        'Customer Calls/Meetings': { solution:'Tiered customer service model with strategic account focus', impact:'Not all customer time is equal. Distribution owners often spend the same amount of time on a $5,000/year account as a $500,000/year account. A tiered model ensures your time goes to the relationships that drive 80% of revenue.', steps:['Rank your customers by annual revenue. Your top 20% likely generate 80% of your revenue. These are your "A" accounts and the only ones that warrant your personal time. B and C accounts get your sales team or customer service.','Block 2 hours every Tuesday and Thursday morning for proactive outreach to A accounts. Not problem-solving; strategic conversations about their growth plans, upcoming projects, and how you can expand the relationship. CEOs who focus on strategic customer work generate 33% more revenue (Gallup).','Create a customer escalation matrix: customer service handles routine inquiries, sales managers handle B-account issues, you handle only A-account escalations and new strategic opportunities above $25K. Post this matrix where your team can see it.','Track your customer-facing hours weekly. Target: 60% strategic (growth conversations, relationship building) and 40% reactive (problem-solving). If the ratio flips, your systems need work, not your schedule.'] },
        'People Management': { solution:'Structured management cadence with written SOPs', impact:'The average SMB owner spends 8-12 hours per week on people management tasks that could be systematized. Clear SOPs and a predictable management rhythm reduce ad-hoc interruptions by 40-60%.', steps:['Implement a weekly management cadence: 15-minute daily standup (what are you working on, what is blocked), 30-minute weekly 1:1 with each direct report, monthly performance review. This structure replaces the constant "got a minute?" interruptions throughout the day.','For every task you repeat more than 3 times, write a 3-bullet SOP: 1) What to do, 2) How to do it, 3) What "done" looks like. Store SOPs in a shared folder. When someone asks you how to do something, point them to the SOP instead of explaining it again.','Define decision rights clearly. Create a one-page document: "Decisions you make without asking me" (hiring temps, scheduling, routine returns), "Decisions you make and inform me" (credits under $1K, vendor substitutions), "Decisions we make together" (new hires, pricing changes, large capital purchases).','Track your interruptions for one week. Every time someone comes to you with a question, note it. At the end of the week, turn the top 5 questions into SOPs or decision-rights updates. Within 60 days, your interruptions will drop by half.'] }
    };

    sorted.filter(t=>t.saved>=0.5).slice(0,5).forEach((t,idx) => {
        const g = guides[t.name] || { solution:'Process automation', impact:'Efficiency gain', steps:['Audit current process end to end.','Document the SOP with clear ownership.','Apply targeted automation tools.','Measure results weekly for 30 days.'] };
        
        const playbookContent = [
            { type: 'title', text: `${idx+1}. ${t.name.toUpperCase()}`, fontSize: 10, style: 'bold', color: C.blue },
            { type: 'text', text: `Recovery Potential: ${t.saved.toFixed(1)}h/week`, fontSize: 8, style: 'bold', color: C.textMid },
            { type: 'space', height: 4 },
            { type: 'text', text: `SOLUTION: ${g.solution}`, fontSize: 8, style: 'bold' },
            { type: 'text', text: `IMPACT: ${g.impact}`, fontSize: 8, color: C.textMid, maxWidth: cw-20 },
            { type: 'space', height: 4 }
        ];

        g.steps.slice(0,4).forEach(step => {
            playbookContent.push({
                type: 'bullet',
                text: step,
                fontSize: 8.5,
                bulletColor: C.blue,
                maxWidth: cw-30
            });
        });
        playbookContent.push({ type: 'space', height: 8 });

        const playbookHeight = dynamicCard(m, y, cw, playbookContent, {accent:C.blue});
        y += playbookHeight + 8;
    });

    // =============================
    // PAGE 5+: ROADMAP + CTA
    // =============================
    newPage();
    y = secTitle('90-DAY TIME RECOVERY ROADMAP', y);
    
    const phases = [
        { t:'DAYS 1-14: TRACK AND ELIMINATE', c:C.green, items:[
            'Week 1 Daily Practice: Before every task, ask yourself "Am I the only person who can do this?" If the answer is no, write a 3-bullet SOP (What to do, How to do it, What done looks like) and hand it off. Target: 2 handoffs per week.',
            'Implement batch email processing immediately: check email at 8 AM, 12 PM, and 4 PM only. Close your inbox between those windows. This recovers 1-2 hours per day by eliminating the 23-minute refocus cost per interruption (UC Irvine).',
            'Create canned responses for your top 10 recurring email questions. Common ones for distributors: pricing requests, lead time inquiries, return policy, credit app status. One click replaces 10 minutes of typing.',
            'Delegate all approvals under $500 with automated notification to you. Review the approval log once daily instead of approving each one live. Expected time savings: 3-5 hours per week.',
            'Deliverable: Written list of every task you touched this week that someone else could have done. Target: recover 5-8 hours per week by Day 14. At $150/hour CEO rate, that is $750-$1,200 per week back in your pocket.'
        ]},
        { t:'DAYS 15-30: SYSTEMATIZE', c:C.amber, items:[
            'Build the automation system for your #1 time drain from the playbook above. If it is pricing, create your rep-facing cheat sheet and approval workflow. If it is order issues, implement validation rules. Start with the single biggest drain.',
            'Draft a one-page "Who Handles What" escalation guide. Three columns: Issue Type, First Responder, Escalation Trigger. Post it where your team can see it. The goal: your team stops defaulting to you for every decision.',
            'Set up a single executive dashboard replacing your top 3 manual reports. Revenue vs. target, margin by category, and AR aging should auto-refresh daily. Check it once each morning for 5 minutes.',
            'Cancel 40-60% of recurring meetings. Replace status updates with shared dashboards. Enforce 25-minute defaults with mandatory agendas 24 hours in advance. No agenda = canceled meeting.',
            'Common Roadblock: Week 3 is when most owners take tasks back. Your team will make mistakes. That is the cost of training. If you take the task back, you have paid the training cost without getting the benefit. Resist the urge. Correct and coach instead.',
            'Deliverable: Escalation guide posted, dashboard live, top time drain automation running. Target: recover 8-12 hours per week by Day 30. That is 2 extra family dinners per week, or 4 gym sessions you have been skipping.'
        ]},
        { t:'DAYS 31-60: AUTOMATE AND DELEGATE', c:C.blue, items:[
            'Deploy customer self-service for order tracking and proof of delivery. Cut "where is my order?" calls by 60-80%. For most distributors, this eliminates 3-6 hours of phone time per week.',
            'Configure automated reorder points for your top 50 A-items using the formula: (Avg Daily Sales x Lead Time) + Safety Stock. Automate PO generation so purchasing happens without your review.',
            'Set up proactive alert systems: inventory below safety stock, shipments not scanned by 2 PM, credit holds on top-50 accounts. Each alert you build prevents a future fire from reaching your desk.',
            'Write response playbooks for your top 3 recurring fire types. Train your team to follow the playbook before escalating. Redirect any escalation covered by a playbook back to the playbook.',
            'Implement tiered customer service: you handle only A-account relationships and opportunities above $25K. Sales managers handle B-accounts. Customer service handles C-accounts and routine inquiries.',
            'Deliverable: Self-service portal live, reorder automation running, fire playbooks posted. Target: recover 12-18 hours per week by Day 60. At $150/hour, that is $93,600-$140,400 per year in recovered CEO capacity. Enough time for a real vacation without your phone buzzing.'
        ]},
        { t:'DAYS 61-90: OPTIMIZE AND GROW', c:C.purple, items:[
            'Re-run your CEO Time Audit. Compare your week now versus your Day 1 baseline. Measure the actual hours recovered and calculate the dollar value. Share the results with your team; they made this happen.',
            'Reallocate recovered hours deliberately. Block 2 hours every Tuesday and Thursday morning for strategic customer outreach to your top 20 accounts. CEOs who focus on strategic work generate 33% more revenue (Gallup). This is where recovered time pays compound returns.',
            'Automate your remaining manual reports. Target: zero recurring reports that require copy-paste from ERP to Excel. Everything auto-generates and auto-delivers on schedule.',
            'Review your decision-rights document. Update it based on 60 days of real-world experience. Add new items your team has proven they can handle. Remove any that caused problems.',
            'Schedule your next audit for Day 180. Continuous improvement is not a project; it is a practice. The owners who sustain results audit quarterly and adjust.',
            'Deliverable: Full before/after comparison, strategic time blocks on calendar, all reports automated. Target: 15-22 hours per week recovered permanently. That is the equivalent of 2-3 extra work days per week focused on growth, or 3 extra evenings per week with your family. Your choice.'
        ]}
    ];

    phases.forEach((p) => {
        // Build card content with title inside the card (same pattern as business dependency)
        const phaseContent = [
            { type: 'title', text: p.t, fontSize: 10, style: 'bold', color: p.c },
            { type: 'space', height: 4 }
        ];
        
        p.items.forEach(item => {
            phaseContent.push({
                type: 'bullet',
                text: item,
                fontSize: 9,
                bulletColor: p.c,
                maxWidth: cw-30
            });
        });
        phaseContent.push({ type: 'space', height: 6 });

        const phaseHeight = dynamicCard(m, y, cw, phaseContent, {accent: p.c});
        y += phaseHeight + 8;
    });

    // Disclaimer - Dynamic
    const disclaimerContent = [
        { type: 'title', text: 'THIS IS NOT AN ERP REPLACEMENT', fontSize: 9, style: 'bold', color: C.green },
        { type: 'space', height: 4 },
        { type: 'text', text: 'We build lightweight automation layers on top of your existing systems. Your ERP, your warehouse software, your accounting tools: they all stay. No rip-and-replace. No 14-month implementation projects. No six-figure consulting fees. We connect what you already have, fill the gaps with targeted automation, and give you your time back in weeks, not years.', fontSize: 8.5, maxWidth: cw-20 },
        { type: 'space', height: 8 }
    ];
    const disclaimerHeight = dynamicCard(m, y, cw, disclaimerContent, {accent:C.green});
    y += disclaimerHeight + 8;

    // CTA - Dynamic
    const ctaContent = [
        { type: 'title', text: "LET'S RECLAIM YOUR TIME", fontSize: 14, style: 'bold', color: C.text, align: 'center' },
        { type: 'space', height: 4 },
        { type: 'text', text: `You are losing ${d.automatableHrs.toFixed(0)} hours every single week to tasks that do not need you.`, fontSize: 9, color: C.textMid, align: 'center' }
    ];

    if(dollarImpact > 0) {
        ctaContent.push({
            type: 'text',
            text: `That is $${dollarImpact.toLocaleString()} per year in CEO opportunity cost.`,
            fontSize: 10,
            style: 'bold',
            color: C.red,
            align: 'center'
        });
    }

    ctaContent.push({ type: 'space', height: 4 });
    ctaContent.push({
        type: 'text',
        text: 'Book a free 15-minute Ops Walkthrough and we will show you exactly where to start.',
        fontSize: 10,
        style: 'bold',
        color: C.amber,
        align: 'center'
    });
    ctaContent.push({ type: 'space', height: 4 });
    ctaContent.push({
        type: 'text',
        text: 'calendly.com/mo-deeplineop/30min',
        fontSize: 10,
        style: 'bold',
        color: C.blue,
        align: 'center'
    });
    ctaContent.push({ type: 'space', height: 4 });
    ctaContent.push({
        type: 'text',
        text: 'mo@deeplineop.ai',
        fontSize: 8,
        color: C.textMid,
        align: 'center'
    });
    ctaContent.push({ type: 'space', height: 8 });

    stroke(C.amber); doc.setLineWidth(1);
    fill(C.card);
    const ctaCardY = y;
    const ctaHeight = dynamicCard(m, y, cw, ctaContent);

    // Measure content heights to find exact Y positions of links inside card
    let linkMeasureY = ctaCardY + 10; // 10px top padding
    ctaContent.forEach(item => {
        if (item.type === 'space') { linkMeasureY += item.height; return; }
        const fs = item.fontSize || 9;
        const fitted = fitText(doc, item.text, item.maxWidth || cw - 20, fs, 7);
        const ih = fitted.lines.length * (fs * 0.55) + 3;
        if (item.text === 'calendly.com/mo-deeplineop/30min') {
            doc.setFontSize(fs); doc.setFont('helvetica','bold');
            const tw = doc.getTextWidth(item.text);
            doc.link(pw/2 - tw/2, linkMeasureY - 1, tw, 7, {url: 'https://calendly.com/mo-deeplineop/30min'});
        } else if (item.text === 'mo@deeplineop.ai') {
            doc.setFontSize(fs); doc.setFont('helvetica','normal');
            const tw = doc.getTextWidth(item.text);
            doc.link(pw/2 - tw/2, linkMeasureY - 1, tw, 6, {url: 'mailto:mo@deeplineop.ai'});
        }
        linkMeasureY += ih;
    });

    // Footer on all pages
    const pc = doc.internal.getNumberOfPages();
    for(let i=1;i<=pc;i++){
        doc.setPage(i);
        fill(C.card); stroke(C.border); doc.rect(0,ph-12,pw,12,'FD');
        txt('Deep Line Operations | AI Automation for Distributors',7,'normal',C.textMid);
        doc.text('Deep Line Operations | AI Automation for Distributors',m,ph-5);
        txt(`Page ${i} of ${pc}`,7,'normal',C.textMid);
        doc.text(`Page ${i} of ${pc}`,pw-m,ph-5,{align:'right'});
    }

    doc.save('CEO-Time-Audit-Report.pdf');
}

init();
</script>
<!-- Navigation Menu --><div id="nav-menu" style="position:fixed;top:16px;right:16px;z-index:10000;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;">
    <button id="nav-toggle" style="background:#12121a;border:1px solid #2a2a3a;color:#f1f5f9;padding:8px 14px;border-radius:8px;cursor:pointer;font-weight:600;display:flex;align-items:center;gap:8px;box-shadow:0 4px 12px rgba(0,0,0,0.5);font-size:14px;">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><rect y="3" width="18" height="2" rx="1" fill="#f1f5f9"/><rect y="8" width="18" height="2" rx="1" fill="#f1f5f9"/><rect y="13" width="18" height="2" rx="1" fill="#f1f5f9"/></svg>
        Tools
    </button>
    <div id="nav-content" style="display:none;position:absolute;top:48px;right:0;background:#12121a;border:1px solid #2a2a3a;border-radius:12px;width:270px;padding:8px;box-shadow:0 8px 24px rgba(0,0,0,0.7);">
        <a href="index.html" style="display:flex;align-items:center;gap:10px;padding:10px 12px;color:#f1f5f9;text-decoration:none;border-radius:6px;font-size:14px;border-left:3px solid #6366f1;background:rgba(99,102,241,0.08);margin-bottom:4px;">
            <img src="logo-icon.png" alt="" style="height:18px;width:18px;object-fit:contain;">
            <strong>All Tools</strong>
        </a>
        <div style="height:1px;background:#2a2a3a;margin:6px 4px;"></div>
        <a href="business-dependency.html" class="nav-link" data-color="#3b82f6" style="display:flex;align-items:center;gap:10px;padding:9px 12px;color:#94a3b8;text-decoration:none;border-radius:6px;font-size:13px;">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><path d="M9 2l6 4v6l-6 4-6-4V6l6-4z" stroke="#3b82f6" stroke-width="1.5" stroke-linejoin="round"/><circle cx="9" cy="9" r="2" fill="#3b82f6"/></svg>
            Business Dependency
        </a>
        <a href="ceo-time-audit.html" class="nav-link" data-color="#f59e0b" style="display:flex;align-items:center;gap:10px;padding:9px 12px;color:#94a3b8;text-decoration:none;border-radius:6px;font-size:13px;">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><rect x="2" y="3" width="14" height="12" rx="2" stroke="#f59e0b" stroke-width="1.5"/><path d="M2 7h14M6 3v-1M12 3v-1" stroke="#f59e0b" stroke-width="1.5" stroke-linecap="round"/><rect x="5" y="9" width="2" height="2" rx=".5" fill="#f59e0b"/><rect x="8" y="9" width="2" height="2" rx=".5" fill="#f59e0b"/></svg>
            CEO Time Audit
        </a>
        <a href="profit-leak-diagnostic.html" class="nav-link" data-color="#ef4444" style="display:flex;align-items:center;gap:10px;padding:9px 12px;color:#94a3b8;text-decoration:none;border-radius:6px;font-size:13px;">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><circle cx="9" cy="9" r="7.5" stroke="#ef4444" stroke-width="1.5"/><path d="M9 5v5l3 2" stroke="#ef4444" stroke-width="1.5" stroke-linecap="round"/><path d="M12 3l2-1M6 3L4 2" stroke="#ef4444" stroke-width="1.2" stroke-linecap="round"/></svg>
            Profit Leak Diagnostic
        </a>
        <a href="ai-readiness-scorecard.html" class="nav-link" data-color="#a855f7" style="display:flex;align-items:center;gap:10px;padding:9px 12px;color:#94a3b8;text-decoration:none;border-radius:6px;font-size:13px;">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><rect x="1" y="1" width="16" height="16" rx="3" stroke="#a855f7" stroke-width="1.5"/><path d="M5 12V8M9 12V5M13 12V9" stroke="#a855f7" stroke-width="2" stroke-linecap="round"/></svg>
            AI Readiness Scorecard
        </a>
        <a href="reorder-calculator.html" class="nav-link" data-color="#22c55e" style="display:flex;align-items:center;gap:10px;padding:9px 12px;color:#94a3b8;text-decoration:none;border-radius:6px;font-size:13px;">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none"><rect x="2" y="6" width="14" height="10" rx="2" stroke="#22c55e" stroke-width="1.5"/><path d="M6 6V4a3 3 0 016 0v2" stroke="#22c55e" stroke-width="1.5"/><circle cx="9" cy="11" r="1.5" fill="#22c55e"/></svg>
            Reorder Calculator
        </a>
    </div>
</div>
<script>
(function(){
    var tgl=document.getElementById('nav-toggle'),cnt=document.getElementById('nav-content');
    if(!tgl||!cnt)return;
    tgl.onclick=function(e){e.stopPropagation();var v=cnt.style.display==='block';cnt.style.display=v?'none':'block';tgl.style.background=v?'#12121a':'#1a1a25';};
    document.addEventListener('click',function(){cnt.style.display='none';tgl.style.background='#12121a';});
    cnt.onclick=function(e){e.stopPropagation();};
    var links=document.querySelectorAll('.nav-link');
    links.forEach(function(l){
        l.onmouseenter=function(){l.style.background='rgba(255,255,255,0.06)';l.style.color='#f1f5f9';};
        l.onmouseleave=function(){if(!l.classList.contains('nav-active')){l.style.background='';l.style.color='#94a3b8';}};
    });
    var cur=window.location.pathname.split('/').pop()||'index.html';
    document.querySelectorAll('#nav-content a').forEach(function(a){
        if(a.getAttribute('href')===cur||(cur===''&&a.getAttribute('href')==='index.html')){
            a.classList.add('nav-active');a.style.background='rgba(255,255,255,0.1)';a.style.color='#fff';a.style.fontWeight='600';
        }
    });
})();
</script>
</body>
</html>
