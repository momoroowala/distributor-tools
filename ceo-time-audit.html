<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEO Time Audit | What's Eating Your Week?</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--bg:#0a0a0f;--card:#12121a;--cell:#1a1a25;--border:#2a2a3a;--text:#f1f5f9;--muted:#94a3b8;--dim:#64748b}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;line-height:1.5}
        .container{max-width:960px;margin:0 auto;padding:1.5rem}
        header{text-align:center;margin-bottom:1.5rem;padding-top:1rem}
        .badge{display:inline-block;background:#f59e0b;color:#000;padding:0.2rem 0.6rem;border-radius:9999px;font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;margin-bottom:0.75rem}
        h1{font-size:2rem;font-weight:700;margin-bottom:0.5rem;background:linear-gradient(135deg,var(--text),#f59e0b);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .subtitle{color:var(--muted);font-size:1rem;max-width:500px;margin:0 auto}
        .section{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:1.5rem;margin-bottom:1.5rem}
        .section h2{font-size:1.1rem;margin-bottom:0.25rem}
        .section .hint{font-size:0.8rem;color:var(--dim);margin-bottom:1rem}
        /* Palette */
        .palette{display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem}
        .palette-item{display:flex;align-items:center;gap:0.4rem;padding:0.4rem 0.75rem;border-radius:0.5rem;cursor:pointer;border:2px solid transparent;font-size:0.75rem;font-weight:600;transition:all 0.15s;user-select:none}
        .palette-item:hover{transform:scale(1.03)}
        .palette-item.active{border-color:#fff;box-shadow:0 0 10px rgba(255,255,255,0.2)}
        .palette-item .dot{width:10px;height:10px;border-radius:3px;flex-shrink:0}
        /* Calendar Grid */
        .cal-wrapper{overflow-x:auto;margin-bottom:1rem}
        .cal{display:grid;grid-template-columns:60px repeat(5,1fr);gap:1px;background:var(--border);border-radius:0.5rem;overflow:hidden;user-select:none}
        .cal-header{background:#1e1e2e;padding:0.5rem;text-align:center;font-size:0.75rem;font-weight:600;color:var(--muted)}
        .cal-time{background:#1e1e2e;padding:0.35rem 0.5rem;font-size:0.7rem;color:var(--dim);display:flex;align-items:center}
        .cal-cell{background:var(--cell);padding:0.3rem;min-height:28px;cursor:pointer;transition:background 0.1s;position:relative;display:flex;align-items:center;justify-content:center;font-size:0.6rem;font-weight:600;color:rgba(255,255,255,0.8)}
        .cal-cell:hover{filter:brightness(1.3)}
        /* Stats Bar */
        .stats-bar{display:flex;gap:1rem;flex-wrap:wrap;margin-top:1rem}
        .stat{flex:1;min-width:120px;background:var(--cell);border-radius:0.5rem;padding:0.75rem;text-align:center}
        .stat .num{font-size:1.4rem;font-weight:700}
        .stat .label{font-size:0.7rem;color:var(--dim)}
        .time-bar{height:24px;border-radius:0.25rem;overflow:hidden;display:flex;margin-top:1rem}
        .time-bar .seg{display:flex;align-items:center;justify-content:center;font-size:0.65rem;font-weight:600;color:#fff;transition:width 0.3s}
        /* Ad Hoc Section */
        .adhoc-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:0.75rem}
        .adhoc-item{background:var(--cell);border-radius:0.5rem;padding:0.75rem}
        .adhoc-item label{display:block;font-size:0.85rem;margin-bottom:0.25rem}
        .adhoc-item .hint{font-size:0.7rem;color:var(--dim);margin-bottom:0.4rem}
        .adhoc-item input{width:100%;padding:0.5rem;background:var(--bg);border:1px solid var(--border);border-radius:0.35rem;color:var(--text);font-size:0.9rem}
        .adhoc-item input:focus{outline:none;border-color:#f59e0b}
        .btn{width:100%;padding:0.9rem;border-radius:0.5rem;font-weight:600;font-size:1rem;cursor:pointer;border:none;margin-top:1rem;transition:all 0.2s}
        .btn-primary{background:#f59e0b;color:#000}
        .btn-primary:hover{background:#fbbf24}
        /* Results */
        .results-page{display:none}.results-page.active{display:block;animation:fadeIn 0.4s ease}
        @keyframes fadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
        .impact-card{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:2rem;text-align:center;margin-bottom:1.5rem}
        .impact-number{font-size:3rem;font-weight:700;line-height:1}
        .impact-label{color:var(--dim);font-size:0.9rem;margin-top:0.25rem}
        .impact-context{color:var(--muted);margin-top:0.75rem;font-size:0.9rem}
        .reclaim-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:0.75rem;margin-top:1.25rem}
        .reclaim-item{background:var(--cell);border-radius:0.5rem;padding:1rem;text-align:center}
        .reclaim-item .number{font-size:1.3rem;font-weight:700;color:#22c55e}
        .reclaim-item .desc{font-size:0.7rem;color:var(--dim);margin-top:0.2rem}
        .before-after{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:1.5rem;margin-bottom:1.5rem}
        .before-after h3{font-size:1rem;margin-bottom:1rem}
        .ba-row{display:flex;gap:1rem}
        .ba-col{flex:1;background:var(--cell);border-radius:0.75rem;padding:1rem}
        .ba-col h4{font-size:0.8rem;text-transform:uppercase;letter-spacing:0.05em;margin-bottom:0.5rem}
        .ba-col.before h4{color:#ef4444}.ba-col.after h4{color:#22c55e}
        .ba-stat{display:flex;justify-content:space-between;padding:0.3rem 0;font-size:0.8rem;border-bottom:1px solid var(--border)}
        .ba-stat:last-child{border-bottom:none}
        .ba-stat .val{font-weight:600}
        .download-section{background:linear-gradient(135deg,rgba(245,158,11,0.1),var(--card));border:2px solid #f59e0b;border-radius:1rem;padding:2rem;text-align:center;margin-bottom:1.5rem}
        .download-section h3{font-size:1.3rem;margin-bottom:0.4rem}
        .download-section>p{color:var(--muted);margin-bottom:1.25rem;font-size:0.9rem}
        .email-form{display:flex;gap:0.75rem;max-width:420px;margin:0 auto;flex-wrap:wrap}
        .email-form input[type="email"]{flex:1;min-width:200px;padding:0.75rem;background:var(--bg);border:1px solid var(--border);border-radius:0.5rem;color:var(--text);font-size:0.95rem}
        .email-form input:focus{outline:none;border-color:#f59e0b}
        .email-form .btn{width:auto;min-width:160px;margin-top:0}
        .download-complete{display:none;color:#22c55e;padding:0.75rem;font-size:0.95rem}
        .download-complete.active{display:block}
        footer{text-align:center;padding:1.5rem;color:var(--dim);font-size:0.8rem}
        footer a{color:#f59e0b;text-decoration:none}
        @media(max-width:700px){.container{padding:1rem}h1{font-size:1.5rem}.reclaim-grid{grid-template-columns:repeat(2,1fr)}.adhoc-grid{grid-template-columns:1fr}.ba-row{flex-direction:column}.cal{font-size:0.6rem}}
    </style>
</head>
<body>
<div class="container">
    <header>
        <span class="badge">Free Tool</span>
        <h1>What's Eating Your Week?</h1>
        <p class="subtitle">Paint your actual calendar. See what a machine should be doing instead of you.</p>
    </header>

    <div id="inputPage">
        <div class="section">
            <h2>Step 1: Paint Your Typical Week</h2>
            <p class="hint">Select a category below, then click or drag on the calendar to fill in your schedule. 9 AM to 9 PM, Monday through Friday.</p>

            <div class="palette" id="palette"></div>

            <div class="cal-wrapper">
                <div class="cal" id="calendar"></div>
            </div>

            <div class="time-bar" id="liveBar"></div>
            <div class="stats-bar" id="liveStats"></div>
        </div>

        <div class="section">
            <h2>Step 2: What Else Eats Your Time?</h2>
            <p class="hint">These tasks don't always show on a calendar but consume real hours every week.</p>
            <div class="adhoc-grid">
                <div class="adhoc-item"><label>Evening email/texts (after 9 PM)</label><div class="hint">Checking phone, responding to messages</div><input type="number" id="adhoc_evening" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
                <div class="adhoc-item"><label>Weekend work</label><div class="hint">Catching up, checking in, emergencies</div><input type="number" id="adhoc_weekend" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
                <div class="adhoc-item"><label>Unplanned interruptions</label><div class="hint">Walk-ins, surprise calls, "got a minute?"</div><input type="number" id="adhoc_interruptions" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
                <div class="adhoc-item"><label>Worrying/thinking about work</label><div class="hint">Laying in bed thinking about problems</div><input type="number" id="adhoc_worry" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
            </div>
        </div>

        <button class="btn btn-primary" onclick="analyze()">üîç Analyze My Week</button>
    </div>

    <div class="results-page" id="resultsPage">
        <div class="impact-card">
            <div class="impact-number" style="color:#ef4444" id="automatableHours">0</div>
            <div class="impact-label">hours per week you spend on tasks a machine could handle</div>
            <div class="impact-context" id="impactContext"></div>
        </div>

        <div class="impact-card" style="border-color:#22c55e">
            <div class="impact-number" style="color:#22c55e" id="reclaimedDays">0</div>
            <div class="impact-label">days per year you could reclaim</div>
            <div class="reclaim-grid" id="reclaimGrid"></div>
        </div>

        <div class="before-after">
            <h3>Your Week: Before vs After Automation</h3>
            <div class="ba-row">
                <div class="ba-col before" id="beforeCol"><h4>üî¥ Now</h4></div>
                <div class="ba-col after" id="afterCol"><h4>üü¢ After</h4></div>
            </div>
        </div>

        <div class="download-section">
            <h3>üìÑ Get Your Time Recovery Plan</h3>
            <p>Detailed PDF with automation recommendations for each time-waster and your "life reclaimed" projection.</p>
            <form class="email-form" id="emailForm" onsubmit="handleDownload(event)">
                <input type="email" id="userEmail" placeholder="Work email" required>
                <button type="submit" class="btn btn-primary">üì• Download PDF</button>
            </form>
            <div class="download-complete" id="downloadComplete">‚úì Report downloaded!</div>
        </div>
    </div>
    <footer><p>Built by <a href="#">Mo Roowala</a> | AI Automation for Distributors</p></footer>
</div>
<script>
const { jsPDF } = window.jspdf;

const categories = [
    { id:'strategy', name:'Strategy & Growth', short:'Strategy', color:'#22c55e', type:'strategic', save:0 },
    { id:'customers', name:'Customer Calls/Meetings', short:'Customers', color:'#06b6d4', type:'strategic', save:0 },
    { id:'pricing', name:'Pricing & Quotes', short:'Pricing', color:'#ef4444', type:'automatable', save:0.75 },
    { id:'orders', name:'Order Issues', short:'Orders', color:'#f97316', type:'automatable', save:0.65 },
    { id:'inventory', name:'Inventory/Purchasing', short:'Inventory', color:'#f43f5e', type:'automatable', save:0.6 },
    { id:'reports', name:'Reports & Data', short:'Reports', color:'#e11d48', type:'automatable', save:0.8 },
    { id:'admin', name:'Admin & Paperwork', short:'Admin', color:'#dc2626', type:'automatable', save:0.7 },
    { id:'fires', name:'Putting Out Fires', short:'Fires', color:'#b91c1c', type:'automatable', save:0.45 },
    { id:'email', name:'Email & Comms', short:'Email', color:'#eab308', type:'delegatable', save:0.35 },
    { id:'meetings', name:'Internal Meetings', short:'Meetings', color:'#a3a3a3', type:'delegatable', save:0.25 },
    { id:'people', name:'People Management', short:'People', color:'#8b5cf6', type:'delegatable', save:0.15 },
    { id:'break', name:'Break / Personal', short:'Break', color:'#374151', type:'neutral', save:0 }
];

const days = ['Mon','Tue','Wed','Thu','Fri'];
const hours = [];
for(let h=9;h<=20;h++) hours.push(h<12?h+'am':h===12?'12pm':(h-12)+'pm');

let selectedCat = 0;
let grid = {}; // key: "day-hour" -> categoryIndex
let isDragging = false;

function init() {
    // Palette
    const pal = document.getElementById('palette');
    pal.innerHTML = categories.map((c,i) => `
        <div class="palette-item ${i===0?'active':''}" onclick="selectCat(${i})" id="pal_${i}" style="background:${c.color}22">
            <div class="dot" style="background:${c.color}"></div>
            <span>${c.name}</span>
        </div>
    `).join('');

    // Calendar
    const cal = document.getElementById('calendar');
    let html = '<div class="cal-header"></div>';
    days.forEach(d => html += `<div class="cal-header">${d}</div>`);

    hours.forEach((h,hi) => {
        html += `<div class="cal-time">${h}</div>`;
        days.forEach((d,di) => {
            const key = `${di}-${hi}`;
            html += `<div class="cal-cell" id="c_${key}" data-key="${key}" 
                onmousedown="startPaint('${key}')" 
                onmouseenter="paint('${key}')"
                ontouchstart="startPaint('${key}')"
                ontouchmove="touchPaint(event)"></div>`;
        });
    });
    cal.innerHTML = html;
    document.addEventListener('mouseup', () => isDragging = false);
    document.addEventListener('touchend', () => isDragging = false);
    updateStats();
}

function selectCat(i) {
    selectedCat = i;
    document.querySelectorAll('.palette-item').forEach(p => p.classList.remove('active'));
    document.getElementById('pal_'+i).classList.add('active');
}

function startPaint(key) {
    isDragging = true;
    toggleCell(key);
}

function paint(key) {
    if(isDragging) toggleCell(key);
}

function touchPaint(e) {
    if(!isDragging) return;
    e.preventDefault();
    const touch = e.touches[0];
    const el = document.elementFromPoint(touch.clientX, touch.clientY);
    if(el && el.dataset && el.dataset.key) toggleCell(el.dataset.key);
}

function toggleCell(key) {
    const cell = document.getElementById('c_'+key);
    if(!cell) return;
    const cat = categories[selectedCat];
    if(grid[key] === selectedCat) {
        delete grid[key];
        cell.style.background = '';
        cell.textContent = '';
    } else {
        grid[key] = selectedCat;
        cell.style.background = cat.color + 'cc';
        cell.textContent = cat.short;
    }
    updateStats();
}

function updateStats() {
    const counts = {};
    categories.forEach((c,i) => counts[i] = 0);
    Object.values(grid).forEach(ci => counts[ci]++);

    const adhocEvening = parseFloat(document.getElementById('adhoc_evening')?.value) || 0;
    const adhocWeekend = parseFloat(document.getElementById('adhoc_weekend')?.value) || 0;
    const adhocInterruptions = parseFloat(document.getElementById('adhoc_interruptions')?.value) || 0;
    const adhocWorry = parseFloat(document.getElementById('adhoc_worry')?.value) || 0;
    const adhocTotal = adhocEvening + adhocWeekend + adhocInterruptions + adhocWorry;

    let strategic=0, delegatable=0, automatable=0, neutral=0;
    categories.forEach((c,i) => {
        if(c.type==='strategic') strategic += counts[i];
        else if(c.type==='delegatable') delegatable += counts[i];
        else if(c.type==='automatable') automatable += counts[i];
        else neutral += counts[i];
    });

    // Ad-hoc is mostly automatable/delegatable
    automatable += adhocInterruptions * 0.5;
    delegatable += adhocEvening + adhocWeekend + adhocInterruptions * 0.5 + adhocWorry;

    const total = strategic + delegatable + automatable + neutral + adhocTotal;

    // Live bar
    const bar = document.getElementById('liveBar');
    if(total > 0) {
        bar.innerHTML = `
            <div class="seg" style="width:${strategic/total*100}%;background:#22c55e">${strategic>0?strategic+'h':''}</div>
            <div class="seg" style="width:${delegatable/total*100}%;background:#eab308">${delegatable>0?Math.round(delegatable)+'h':''}</div>
            <div class="seg" style="width:${automatable/total*100}%;background:#ef4444">${automatable>0?Math.round(automatable)+'h':''}</div>
            <div class="seg" style="width:${neutral/total*100}%;background:#374151">${neutral>0?neutral+'h':''}</div>
        `;
    }

    // Live stats
    const calHours = Object.keys(grid).length;
    document.getElementById('liveStats').innerHTML = `
        <div class="stat"><div class="num">${calHours + adhocTotal}</div><div class="label">Total Hours</div></div>
        <div class="stat"><div class="num" style="color:#22c55e">${strategic}</div><div class="label">Strategic</div></div>
        <div class="stat"><div class="num" style="color:#eab308">${Math.round(delegatable)}</div><div class="label">Delegatable</div></div>
        <div class="stat"><div class="num" style="color:#ef4444">${Math.round(automatable)}</div><div class="label">Automatable</div></div>
    `;
}

function analyze() {
    const calHours = Object.keys(grid).length;
    const adhocEvening = parseFloat(document.getElementById('adhoc_evening').value) || 0;
    const adhocWeekend = parseFloat(document.getElementById('adhoc_weekend').value) || 0;
    const adhocInterruptions = parseFloat(document.getElementById('adhoc_interruptions').value) || 0;
    const adhocWorry = parseFloat(document.getElementById('adhoc_worry').value) || 0;

    if(calHours < 10) { alert('Please fill in more of your calendar (at least 10 hours).'); return; }

    // Count hours per category
    const catHours = {};
    categories.forEach((c,i) => catHours[i] = 0);
    Object.values(grid).forEach(ci => catHours[ci]++);

    // Build task breakdown
    let totalHrs = 0;
    let automatableHrs = 0;
    const breakdown = [];

    categories.forEach((c,i) => {
        let hrs = catHours[i] || 0;
        if(hrs === 0) return;
        const saved = hrs * c.save;
        automatableHrs += saved;
        totalHrs += hrs;
        breakdown.push({ ...c, hours: hrs, saved });
    });

    // Add ad hoc
    const adhocs = [
        { name:'Evening email/texts', hours:adhocEvening, save:0.6, type:'delegatable' },
        { name:'Weekend work', hours:adhocWeekend, save:0.4, type:'delegatable' },
        { name:'Unplanned interruptions', hours:adhocInterruptions, save:0.4, type:'automatable' },
        { name:'Worrying about work', hours:adhocWorry, save:0.3, type:'automatable' }
    ];
    adhocs.forEach(a => {
        if(a.hours > 0) {
            automatableHrs += a.hours * a.save;
            totalHrs += a.hours;
            breakdown.push({ name:a.name, hours:a.hours, saved:a.hours*a.save, type:a.type, color:'#6b7280' });
        }
    });

    // Show results
    document.getElementById('inputPage').style.display = 'none';
    document.getElementById('resultsPage').classList.add('active');

    document.getElementById('automatableHours').textContent = automatableHrs.toFixed(1);
    const yearlyHrs = Math.round(automatableHrs * 52);
    const yearlyDays = Math.round(yearlyHrs / 8);
    document.getElementById('reclaimedDays').textContent = yearlyDays;

    const pctAutomate = ((automatableHrs / totalHrs) * 100).toFixed(0);
    document.getElementById('impactContext').innerHTML = `<strong>${pctAutomate}%</strong> of your ${totalHrs}-hour work week is spent on tasks that don't need you. That's <strong>${yearlyHrs.toLocaleString()} hours per year</strong>.`;

    const dinners = Math.round(yearlyHrs / 2.5);
    const vacWeeks = (yearlyDays / 5).toFixed(1);
    const events = Math.round(yearlyHrs / 2);
    document.getElementById('reclaimGrid').innerHTML = `
        <div class="reclaim-item"><div class="number">${dinners}</div><div class="desc">Family dinners</div></div>
        <div class="reclaim-item"><div class="number">${vacWeeks}</div><div class="desc">Weeks of vacation</div></div>
        <div class="reclaim-item"><div class="number">${events}</div><div class="desc">Kids' events</div></div>
        <div class="reclaim-item"><div class="number">${yearlyHrs.toLocaleString()}</div><div class="desc">Hours for growth</div></div>
    `;

    // Before/After
    const bCol = document.getElementById('beforeCol');
    const aCol = document.getElementById('afterCol');
    bCol.innerHTML = '<h4>üî¥ Now</h4>';
    aCol.innerHTML = '<h4>üü¢ After</h4>';
    breakdown.sort((a,b) => b.hours - a.hours).forEach(t => {
        bCol.innerHTML += `<div class="ba-stat"><span>${t.name}</span><span class="val">${t.hours}h</span></div>`;
        const after = (t.hours - t.saved).toFixed(1);
        aCol.innerHTML += `<div class="ba-stat"><span>${t.name}</span><span class="val" style="color:${t.saved>0?'#22c55e':'inherit'}">${after}h</span></div>`;
    });
    bCol.innerHTML += `<div class="ba-stat" style="border-top:2px solid var(--border);margin-top:0.4rem;padding-top:0.4rem"><span><strong>Total</strong></span><span class="val">${totalHrs}h</span></div>`;
    aCol.innerHTML += `<div class="ba-stat" style="border-top:2px solid var(--border);margin-top:0.4rem;padding-top:0.4rem"><span><strong>Total</strong></span><span class="val" style="color:#22c55e">${(totalHrs - automatableHrs).toFixed(1)}h</span></div>`;

    window._data = { totalHrs, automatableHrs, yearlyHrs, yearlyDays, breakdown, dinners, vacWeeks, events };
}

function handleDownload(e) {
    e.preventDefault();
    const email = document.getElementById('userEmail').value;
    const leads = JSON.parse(localStorage.getItem('timeaudit_leads') || '[]');
    leads.push({ email, timestamp: new Date().toISOString(), data: window._data });
    localStorage.setItem('timeaudit_leads', JSON.stringify(leads));
    generatePDF(email);
    document.getElementById('emailForm').style.display = 'none';
    document.getElementById('downloadComplete').classList.add('active');
}

function generatePDF(email) {
    const d = window._data;
    const doc = new jsPDF();
    const pw = doc.internal.pageSize.getWidth();
    const m = 18, cw = pw - 2*m;
    let y = 0;
    const txt = (s,sz,st='normal',c=[52,52,56]) => { doc.setFontSize(sz); doc.setFont('helvetica',st); doc.setTextColor(...c); };
    const cp = (n=25) => { if(y+n>268){doc.addPage();addPageBg();y=18;} };
    const addPageBg = () => { doc.setFillColor(236,233,228); doc.rect(0,0,pw,297,'F'); };

    // ---- PAGE 1: COVER ----
    addPageBg();
    doc.setFillColor(30,30,42);
    doc.rect(0,0,pw,48,'F');
    txt('CEO TIME AUDIT REPORT',20,'bold',[255,255,255]);
    doc.text('CEO TIME AUDIT REPORT',pw/2,18,{align:'center'});
    txt("Your Personalized Time Recovery Analysis",10,'normal',[180,180,200]);
    doc.text("Your Personalized Time Recovery Analysis",pw/2,28,{align:'center'});
    txt(`${email} | ${new Date().toLocaleDateString()}`,8,'normal',[140,140,160]);
    doc.text(`${email} | ${new Date().toLocaleDateString()}`,pw/2,38,{align:'center'});

    y = 58;

    // ---- EXECUTIVE SUMMARY ----
    doc.setFillColor(243,238,228);
    doc.setDrawColor(245,158,11);
    doc.roundedRect(m,y,cw,50,3,3,'FD');
    txt('EXECUTIVE SUMMARY',10,'bold',[245,158,11]);
    doc.text('EXECUTIVE SUMMARY',m+5,y+10);

    const totalHrs = d.breakdown.reduce((s,t) => s+t.hours,0);
    const strategicHrs = d.breakdown.filter(t=>t.type==='strategic').reduce((s,t)=>s+t.hours,0);
    const strategicPct = totalHrs > 0 ? Math.round((strategicHrs/totalHrs)*100) : 0;

    txt(`You reported ${totalHrs} hours/week across ${d.breakdown.filter(t=>t.hours>0).length} task categories.`,9,'normal',[58,58,62]);
    doc.text(`You reported ${totalHrs} hours/week across ${d.breakdown.filter(t=>t.hours>0).length} task categories.`,m+5,y+18);

    txt(`${d.automatableHrs.toFixed(1)} hours/week (${Math.round(d.automatableHrs/totalHrs*100)}%) can be automated or delegated.`,9,'bold',[52,52,56]);
    doc.text(`${d.automatableHrs.toFixed(1)} hours/week (${Math.round(d.automatableHrs/totalHrs*100)}%) can be automated or delegated.`,m+5,y+26);

    txt(`Only ${strategicPct}% of your time goes to strategic, growth-driving work.`,9,'normal',[58,58,62]);
    doc.text(`Only ${strategicPct}% of your time goes to strategic, growth-driving work.`,m+5,y+34);

    txt(`Annual impact: ${d.yearlyDays} workdays, ${d.dinners} family dinners, ${d.vacWeeks} weeks of vacation.`,9,'bold',[245,158,11]);
    doc.text(`Annual impact: ${d.yearlyDays} workdays, ${d.dinners} family dinners, ${d.vacWeeks} weeks of vacation.`,m+5,y+42);
    y += 60;

    // ---- VISUAL TIME BREAKDOWN ----
    txt('WHERE YOUR TIME GOES',14,'bold',[30,30,42]);
    doc.text('WHERE YOUR TIME GOES',m,y);
    y += 4;
    txt('Sorted by recovery potential (highest savings first)',8,'normal',[120,120,120]);
    doc.text('Sorted by recovery potential (highest savings first)',m,y+4);
    y += 12;

    const sorted = [...d.breakdown].filter(t=>t.hours>0).sort((a,b)=>b.saved-a.saved);
    const maxHrs = Math.max(...sorted.map(t=>t.hours));

    sorted.forEach((t,i) => {
        cp(18);
        const typeColors = { strategic:[34,197,94], delegatable:[245,158,11], automatable:[239,68,68] };
        const col = typeColors[t.type] || [100,100,100];

        // Task name and hours
        txt(t.name,8,'bold',[58,58,62]);
        doc.text(t.name,m,y+4);
        txt(`${t.hours}h/wk`,8,'normal',[100,100,100]);
        doc.text(`${t.hours}h/wk`,m+68,y+4);

        // Current time bar
        const barStart = m + 82;
        const barMaxW = cw - 82;
        const currentW = (t.hours/maxHrs) * barMaxW;
        const afterW = ((t.hours - t.saved)/maxHrs) * barMaxW;

        // Full bar (current)
        doc.setFillColor(220,218,214);
        doc.roundedRect(barStart,y,currentW,4,1,1,'F');

        // After-automation bar
        doc.setFillColor(...col);
        doc.roundedRect(barStart,y,Math.max(afterW,1),4,1,1,'F');

        // Savings label
        if(t.saved > 0) {
            txt(`-${t.saved.toFixed(1)}h`,7,'bold',[239,68,68]);
            doc.text(`-${t.saved.toFixed(1)}h`,barStart+currentW+3,y+3);
        }

        // Type badge
        const typeLabel = t.type === 'strategic' ? 'STRATEGIC' : t.type === 'delegatable' ? 'DELEGATE' : 'AUTOMATE';
        txt(typeLabel,6,'bold',col);
        doc.text(typeLabel,m,y+10);
        y += 14;
    });
    y += 5;

    // ---- CATEGORY SUMMARY (pie chart style) ----
    cp(45);
    txt('TIME BY CATEGORY',12,'bold',[30,30,42]);
    doc.text('TIME BY CATEGORY',m,y);
    y += 10;

    const categories = [
        { label:'Strategic (keep)', color:[34,197,94], hrs: d.breakdown.filter(t=>t.type==='strategic').reduce((s,t)=>s+t.hours,0) },
        { label:'Delegatable (train team)', color:[245,158,11], hrs: d.breakdown.filter(t=>t.type==='delegatable').reduce((s,t)=>s+t.hours,0) },
        { label:'Automatable (use technology)', color:[239,68,68], hrs: d.breakdown.filter(t=>t.type==='automatable').reduce((s,t)=>s+t.hours,0) }
    ];

    categories.forEach(cat => {
        if(cat.hrs <= 0) return;
        const pct = Math.round((cat.hrs/totalHrs)*100);
        const barW = (pct/100) * (cw - 60);

        doc.setFillColor(...cat.color);
        doc.roundedRect(m,y,barW,8,2,2,'F');
        txt(`${cat.label}: ${cat.hrs}h (${pct}%)`,8,'bold',cat.color);
        doc.text(`${cat.label}: ${cat.hrs}h (${pct}%)`,m+barW+5,y+6);
        y += 13;
    });
    y += 5;

    // ---- BEFORE vs AFTER COMPARISON ----
    cp(35);
    doc.setFillColor(228,232,240);
    doc.roundedRect(m,y,cw,30,3,3,'F');
    txt('YOUR WEEK: BEFORE vs AFTER AUTOMATION',10,'bold',[59,130,246]);
    doc.text('YOUR WEEK: BEFORE vs AFTER AUTOMATION',pw/2,y+9,{align:'center'});

    const afterTotal = totalHrs - d.automatableHrs;
    txt(`NOW: ${totalHrs}h/week`,10,'bold',[239,68,68]);
    doc.text(`NOW: ${totalHrs}h/week`,m+15,y+20);
    txt('>>',10,'bold',[100,100,100]);
    doc.text('>>',pw/2-5,y+20);
    txt(`AFTER: ${afterTotal.toFixed(1)}h/week`,10,'bold',[34,197,94]);
    doc.text(`AFTER: ${afterTotal.toFixed(1)}h/week`,pw/2+10,y+20);
    txt(`${d.automatableHrs.toFixed(1)}h/week recovered`,9,'bold',[245,158,11]);
    doc.text(`${d.automatableHrs.toFixed(1)}h/week recovered`,pw-m-5,y+20,{align:'right'});
    y += 40;

    // ---- DETAILED AUTOMATION PLANS (full page) ----
    doc.addPage(); addPageBg(); y = 20;
    txt('DETAILED AUTOMATION PLAYBOOK',16,'bold',[245,158,11]);
    doc.text('DETAILED AUTOMATION PLAYBOOK',pw/2,y,{align:'center'});
    y += 5;
    txt('Step-by-step plans for each area, prioritized by time savings',9,'normal',[100,100,100]);
    doc.text('Step-by-step plans for each area, prioritized by time savings',pw/2,y+5,{align:'center'});
    y += 18;

    const guides = {
        'Pricing & Quotes': {
            solution:'Rule-based pricing engine with automated approval workflows',
            impact: 'Reduces quoting time by 60-80%. Eliminates margin erosion from inconsistent pricing.',
            steps:[
                'Week 1: Audit your last 90 days of quotes. Identify the 10 most common quote types and your pricing patterns for each.',
                'Week 2: Create a pricing matrix by customer tier (A/B/C) and product category. Document floor prices, target margins, and volume breaks.',
                'Week 3: Configure your ERP or quoting tool with the matrix. Set auto-approval for quotes within defined ranges.',
                'Week 4: Train your team on the new system. Role-play 20 common quoting scenarios to build confidence.',
                'Week 5-6: Implement exception-only escalation. Only quotes below floor price or unusual terms come to you.',
                'Month 3: Review override frequency and margin impact weekly. Tighten rules as team gains confidence. Target: 90% of quotes handled without you.'
            ],
            quickWin: 'Create templates for your top 5 most common quote types today. This alone saves 30-45 minutes per day.'
        },
        'Order Issues': {
            solution:'Order validation engine with customer self-service portal',
            impact: 'Reduces order errors by 70%+ and processing time by 50%. Frees you from being the "order fixer."',
            steps:[
                'Week 1: Track every order issue for 5 days. Categorize: wrong item, wrong quantity, wrong price, wrong address, duplicate. Find the top 3 patterns.',
                'Week 2: Build validation rules for each pattern. Example: flag orders where quantity exceeds 2x historical average, or price differs from last order by >10%.',
                'Week 3: Implement validation in your order entry workflow. Errors get caught before they ship.',
                'Week 4: Create a customer-facing order portal for your top 20 accounts. Let them place, track, and reorder without calling.',
                'Week 5-6: Set up automated order confirmation emails with details and expected delivery dates.',
                'Month 3: Measure error rate weekly. Target: you personally touch fewer than 5% of orders, only true exceptions.'
            ],
            quickWin: 'Add a mandatory "review before submit" screen with order summary. Catches 40% of entry errors immediately.'
        },
        'Inventory/Purchasing': {
            solution:'Demand forecasting with automated reorder point management',
            impact: 'Reduces stockouts by 50%+, cuts excess inventory 20-30%, and frees working capital.',
            steps:[
                'Week 1: Run an ABC analysis on your entire inventory. A items = top 80% of revenue, B = next 15%, C = bottom 5%.',
                'Week 2: Calculate reorder points for all A items: (Average daily usage x Lead time) + Safety stock buffer.',
                'Week 3: Set up automated reorder alerts in your ERP for A items. Most systems have this built in but underused.',
                'Week 4: Identify dead stock (no movement in 12+ months). Create liquidation plan: discount, bundle, donate, scrap.',
                'Week 5-6: Implement cycle counting. Count A items monthly, B quarterly, C annually. Eliminate the painful annual full count.',
                'Month 3: Track fill rate and stockout metrics weekly. Target 95%+ fill rate. Review and adjust safety stock levels based on actual demand patterns.'
            ],
            quickWin: 'Set up reorder alerts for your top 20 SKUs by volume today. Prevents the stockout calls that eat your mornings.'
        },
        'Reports & Data': {
            solution:'Automated dashboards replacing manual spreadsheet compilation',
            impact: 'Eliminates 80-90% of manual reporting time. Gives team self-service access to data.',
            steps:[
                'Week 1: List every report you create or review weekly. For each one, note: who needs it, how often, how long it takes to build.',
                'Week 2: Identify the top 5 most time-consuming reports. Most can be automated with your existing ERP or a simple BI tool.',
                'Week 3: Build automated versions of the top 3 reports. Schedule them to run and email automatically.',
                'Week 4: Create a real-time KPI dashboard (even a shared Google Sheet with auto-refresh works). Cover: daily orders, revenue, margin, inventory turns.',
                'Week 5-6: Train team to pull their own data. Create 1-page guides for "how to find X" for common requests.',
                'Month 3: Eliminate all manual spreadsheet compilation. If a human is copy-pasting data between systems, that process is broken.'
            ],
            quickWin: 'Schedule your #1 most-requested report to auto-generate and email every Monday morning. One less thing to do every week.'
        },
        'Admin & Paperwork': {
            solution:'Digital workflows replacing paper-based and manual approval processes',
            impact: 'Cuts administrative overhead by 40-60%. Eliminates document hunting and approval bottlenecks.',
            steps:[
                'Week 1: Map every approval chain you are part of. For each, ask: what is the threshold? Can anyone else approve below that threshold?',
                'Week 2: Set tiered approval authority. Under $500 = team lead. $500-$2,000 = manager. Over $2,000 = you. Document and communicate.',
                'Week 3: Digitize your top 5 paper forms. Free tools like Google Forms or JotForm work. Route submissions automatically.',
                'Week 4: Implement e-signatures for routine documents (DocuSign, HelloSign). Stop printing, signing, scanning.',
                'Week 5-6: Automate invoice processing. Set up AP automation for recurring vendors with known pricing.',
                'Month 3: Audit your approval queue weekly. If you are still approving routine items, delegate further. Target: only strategic or unusual approvals reach you.'
            ],
            quickWin: 'Delegate all approvals under $500 to your most trusted team lead today. That alone could save 2-3 hours per week.'
        },
        'Putting Out Fires': {
            solution:'Proactive monitoring system with early warning alerts and response playbooks',
            impact: 'Reduces reactive firefighting by 60-80%. Prevents crises instead of responding to them.',
            steps:[
                'Week 1: Log every "fire" for 5 days straight. Categorize by type, root cause, and time spent. You will see patterns immediately.',
                'Week 2: For each recurring fire type, write a one-page response playbook. Include: who handles it, steps to resolve, who to escalate to (not you).',
                'Week 3: Build automated alerts for the conditions that precede fires. Late shipment? Alert before the customer calls. Low inventory on fast-mover? Alert before stockout.',
                'Week 4: Assign fire-fighting authority to specific team members. Pricing issues = sales manager. Delivery issues = ops lead. You are the last resort, not the first call.',
                'Week 5-6: Implement a root cause tracking system. Every fire gets a "why did this happen?" entry. Review monthly to fix systemic issues.',
                'Month 3: Track fires per week. Target 50% reduction by fixing root causes. The best fire is the one that never starts.'
            ],
            quickWin: 'Identify your #1 most frequent fire type. Write the playbook and hand it to someone today.'
        },
        'Email & Comms': {
            solution:'Smart email management with templates, batching, and delegation',
            impact: 'Reduces email time by 50-70%. Reclaims the most fragmented hours of your day.',
            steps:[
                'Week 1: Track email volume for 5 days. Categorize: requires your decision, informational, could be handled by team, should not come to you at all.',
                'Week 2: Create canned responses for your 15-20 most common email types. Pricing inquiries, order status, account setup, etc.',
                'Week 3: Set up email filters and rules. Route operational emails directly to the responsible team member. You get CC\'d, not TO\'d.',
                'Week 4: Implement email batching. Check email 3x daily (morning, after lunch, end of day) instead of constantly. Communicate this to your team.',
                'Week 5-6: Delegate routine correspondence entirely. Train a team member to respond on your behalf for operational items.',
                'Month 3: Measure your daily email time. Target: under 45 minutes total. Everything else should be handled by systems or team.'
            ],
            quickWin: 'Turn off email notifications right now. Check 3x daily instead of constantly. This alone recovers 1-2 hours of focused time.'
        },
        'Internal Meetings': {
            solution:'Async-first communication with purpose-driven meeting structure',
            impact: 'Recovers 30-50% of meeting time. Improves decision quality by forcing preparation.',
            steps:[
                'Week 1: Audit your calendar. For every recurring meeting, answer: What decisions get made? What would happen if we cancelled this?',
                'Week 2: Convert all status update meetings to async formats. Shared dashboards, Slack updates, or brief written summaries replace the "round-the-table" meeting.',
                'Week 3: Implement meeting rules: 25-minute default (not 30 or 60), required written agenda 24h before, no agenda = cancelled.',
                'Week 4: Cancel any meeting where you are an observer, not a decision-maker. Ask for written summaries instead.',
                'Week 5-6: Batch remaining meetings into 2-3 days per week. Protect at least 2 full "no meeting" days for deep work.',
                'Month 3: Count your weekly meeting hours. Target: 50% reduction from baseline. Freed time goes to strategy and growth.'
            ],
            quickWin: 'Cancel your least valuable recurring meeting this week. If nobody complains in 2 weeks, it was not needed.'
        },
        'Customer Calls': {
            solution:'Tiered customer management with proactive communication systems',
            impact: 'Reduces reactive customer calls by 40-60% while improving satisfaction.',
            steps:[
                'Week 1: Categorize your customer calls by type. Most fall into: order status, pricing questions, complaints, reorders, relationship maintenance.',
                'Week 2: For order status and routine inquiries, build self-service options. Customer portal, automated tracking emails, FAQ page.',
                'Week 3: Assign account managers to handle routine calls for your top 20 accounts. Introduce them with a warm handoff.',
                'Week 4: Set up proactive outbound communication. Monthly check-ins, automated reorder reminders, and satisfaction surveys replace reactive calls.',
                'Week 5-6: Create a customer escalation matrix. Level 1 = team handles. Level 2 = manager handles. Level 3 = you handle. Define clear criteria.',
                'Month 3: Track calls that reach you directly. Target: only strategic conversations (renewals, expansions, key account issues). Everything else is handled.'
            ],
            quickWin: 'Route all "where is my order?" calls to a team member with system access. That one change frees significant time.'
        },
        'Strategy & Growth': {
            solution:'Protected strategic time with structured planning cadence',
            impact: 'This is the category you should be INCREASING, not automating.',
            steps:[
                'Week 1: Block 2 hours every morning (your sharpest hours) for strategic work only. No email, no calls, no interruptions.',
                'Week 2: Create a strategic priorities list. No more than 3 big-picture goals per quarter. Write them down and review weekly.',
                'Week 3: Schedule monthly strategy sessions with your key leaders. Review KPIs, discuss market changes, plan next moves.',
                'Week 4: Start tracking competitive intelligence. Set Google Alerts for your top 5 competitors and industry trends.',
                'Week 5-6: Build a 90-day rolling plan. What are you building? What are you testing? What are you measuring?',
                'Month 3: Measure what percentage of your time goes to strategy vs. operations. Target: at least 30% strategic. This is where your business grows.'
            ],
            quickWin: 'Block tomorrow morning 8-10am for strategic thinking. Turn everything else off. Protect it like a customer meeting.'
        },
        'HR & People': {
            solution:'Systematized people management with clear processes and delegation',
            impact: 'Reduces people-management overhead by 40% while building stronger team culture.',
            steps:[
                'Week 1: Identify which HR tasks only you can do (hiring decisions, terminations, compensation) vs. everything else.',
                'Week 2: Delegate scheduling, timekeeping, and routine personnel questions to an office manager or team lead.',
                'Week 3: Create an employee handbook covering the 20 most common questions. Stop answering the same things repeatedly.',
                'Week 4: Implement structured 1-on-1s (15 min biweekly) instead of ad-hoc conversations. More efficient and more effective.',
                'Week 5-6: Set up performance review templates and self-assessments. The process should run on a calendar, not on your memory.',
                'Month 3: Evaluate your HR time. Target: only strategic people decisions (hiring, org design, culture). Operational HR is delegated.'
            ],
            quickWin: 'Write answers to the 5 most common employee questions and share them. Stop being a human FAQ.'
        },
        'Other': {
            solution:'Audit and eliminate or delegate miscellaneous time drains',
            impact: 'The "other" category often hides the biggest time sinks because they feel unavoidable.',
            steps:[
                'Week 1: Track what "other" actually means for 5 days. Write down every task that falls here. Be specific.',
                'Week 2: For each task, ask: Does this generate revenue? Does this prevent loss? Is this truly my job? If no to all three, stop doing it.',
                'Week 3: Delegate viable tasks with clear instructions. Create simple checklists for each one.',
                'Week 4: Automate any remaining repetitive tasks. Even simple automation (templates, reminders, auto-forwards) helps.',
                'Week 5-6: Review what is left. If tasks keep appearing in "other," they need a proper home in your workflow or someone else\'s job description.',
                'Month 3: The "other" category should be under 2 hours per week. If it is not, you have delegation or process gaps to close.'
            ],
            quickWin: 'Pick the single most annoying "other" task and either delegate it or create a system for it today.'
        }
    };

    sorted.filter(t=>t.saved>=0.3).forEach((t,idx) => {
        const g = guides[t.name];
        if(!g) return;
        cp(70);

        // Section header bar
        const typeColors = { strategic:[34,197,94], delegatable:[245,158,11], automatable:[239,68,68] };
        const col = typeColors[t.type] || [100,100,100];

        doc.setFillColor(...col);
        doc.roundedRect(m,y,cw,10,2,2,'F');
        txt(`#${idx+1}: ${t.name.toUpperCase()}`,10,'bold',[255,255,255]);
        doc.text(`#${idx+1}: ${t.name.toUpperCase()}`,m+5,y+7);
        txt(`Save ${t.saved.toFixed(1)}h/week`,9,'bold',[255,255,255]);
        doc.text(`Save ${t.saved.toFixed(1)}h/week`,pw-m-5,y+7,{align:'right'});
        y += 15;

        // Solution & Impact
        txt(`Solution: ${g.solution}`,9,'bold',[58,58,62]);
        const solLines = doc.splitTextToSize(`Solution: ${g.solution}`,cw-5);
        doc.text(solLines,m,y);
        y += solLines.length*4.5+2;

        txt(`Impact: ${g.impact}`,8,'normal',[82,82,85]);
        const impLines = doc.splitTextToSize(`Impact: ${g.impact}`,cw-5);
        doc.text(impLines,m,y);
        y += impLines.length*4+4;

        // Quick Win
        doc.setFillColor(240,236,220);
        const qwLines = doc.splitTextToSize(`Quick Win: ${g.quickWin}`,cw-14);
        doc.roundedRect(m,y-2,cw,qwLines.length*4.5+8,2,2,'F');
        txt(`Quick Win: ${g.quickWin}`,8,'bold',[180,120,0]);
        doc.text(qwLines,m+5,y+4);
        y += qwLines.length*4.5+10;

        // Action Steps
        txt('ACTION STEPS:',9,'bold',[58,58,62]);
        doc.text('ACTION STEPS:',m,y);
        y += 6;

        g.steps.forEach(step => {
            cp(14);
            txt(step,8,'normal',[65,65,68]);
            const lines = doc.splitTextToSize(step,cw-8);
            doc.text(lines,m+5,y);
            y += lines.length*4+3;
        });
        y += 8;
    });

    // ---- 90-DAY IMPLEMENTATION ROADMAP ----
    doc.addPage(); addPageBg(); y = 20;
    txt('YOUR 90-DAY TIME RECOVERY ROADMAP',16,'bold',[245,158,11]);
    doc.text('YOUR 90-DAY TIME RECOVERY ROADMAP',pw/2,y,{align:'center'});
    y += 15;

    const topAreas = sorted.filter(t=>t.saved>=0.5).slice(0,4).map(t=>t.name);
    const phases = [
        { title:'DAYS 1-14: QUICK WINS', color:[34,197,94], desc:'Low-effort, high-impact changes you can make this week.', items:[
            'Implement email batching (3x daily check) and turn off notifications.',
            topAreas[0] ? `Create templates/playbooks for ${topAreas[0]} (your biggest time drain).` : 'Create templates for your most common repetitive task.',
            'Delegate all approvals under $500 to your team lead.',
            'Cancel or convert your least valuable recurring meeting to async.',
            'Block 2 hours every morning for strategic work only.',
            'Expected savings: 3-5 hours/week immediately.'
        ]},
        { title:'DAYS 15-30: FOUNDATIONS', color:[245,158,11], desc:'Build the systems that replace your manual involvement.', items:[
            topAreas[0] ? `Build the full system for ${topAreas[0]}: rules, workflows, and team training.` : 'Systematize your top time-drain area.',
            topAreas[1] ? `Start automation for ${topAreas[1]}: document process, build templates, assign owner.` : 'Start automating your second biggest time drain.',
            'Set up dashboards to replace manual reporting.',
            'Train team members on new responsibilities with written guides.',
            'Create escalation matrix: Level 1 (team), Level 2 (manager), Level 3 (you).',
            'Expected savings: 5-8 hours/week cumulative.'
        ]},
        { title:'DAYS 31-60: AUTOMATION', color:[59,130,246], desc:'Deploy technology solutions and expand delegation.', items:[
            'Configure ERP automation for pricing, reorder points, and order validation.',
            topAreas[2] ? `Fully automate or delegate ${topAreas[2]}.` : 'Tackle your third priority area.',
            'Launch customer self-service options (portal, tracking, FAQ).',
            'Implement proactive monitoring alerts to prevent fires before they start.',
            'Expand team authority as trust builds from first 30 days.',
            'Expected savings: 8-12 hours/week cumulative.'
        ]},
        { title:'DAYS 61-90: OPTIMIZATION', color:[139,92,246], desc:'Fine-tune, measure results, and protect your recovered time.', items:[
            'Review all KPIs: time per task, error rates, customer satisfaction, team confidence.',
            'Fine-tune automation rules and delegation thresholds based on real results.',
            'Reallocate recovered time to strategy, growth, and relationship-building.',
            'Create a personal "time budget" for the next quarter. Protect strategic hours.',
            `Target: ${d.automatableHrs.toFixed(0)}+ hours/week recovered, ${Math.round(strategicPct + (d.automatableHrs/totalHrs*60))}%+ time on strategic work.`,
            'Schedule quarterly time audit to prevent old habits from creeping back.'
        ]}
    ];

    phases.forEach(phase => {
        cp(55);
        doc.setFillColor(...phase.color);
        doc.roundedRect(m,y,cw,8,2,2,'F');
        txt(phase.title,10,'bold',[255,255,255]);
        doc.text(phase.title,m+4,y+6);
        y += 12;

        txt(phase.desc,8,'italic',[100,100,100]);
        doc.text(phase.desc,m+3,y); y += 7;

        phase.items.forEach(item => {
            cp(12);
            txt(item,8,'normal',[65,65,68]);
            const lines = doc.splitTextToSize('  '+item,cw-10);
            doc.text(lines,m+5,y);
            y += lines.length*4+3;
        });
        y += 8;
    });

    // ---- ROI PROJECTION ----
    cp(65);
    y += 5;
    txt('RETURN ON INVESTMENT',14,'bold',[245,158,11]);
    doc.text('RETURN ON INVESTMENT',pw/2,y,{align:'center'});
    y += 12;

    doc.setFillColor(243,238,228);
    doc.roundedRect(m,y,cw,50,3,3,'F');
    doc.setDrawColor(245,158,11);
    doc.roundedRect(m,y,cw,50,3,3,'S');

    const hourlyValue = 150;
    const weeklyValue = d.automatableHrs * hourlyValue;
    const annualValue = weeklyValue * 50;

    txt('VALUE OF RECOVERED TIME',10,'bold',[52,52,56]);
    doc.text('VALUE OF RECOVERED TIME',pw/2,y+10,{align:'center'});

    txt(`At $${hourlyValue}/hr CEO value: $${weeklyValue.toLocaleString()}/week = $${annualValue.toLocaleString()}/year`,9,'normal',[75,75,78]);
    doc.text(`At $${hourlyValue}/hr CEO value: $${weeklyValue.toLocaleString()}/week = $${annualValue.toLocaleString()}/year`,pw/2,y+20,{align:'center'});

    txt(`${d.yearlyDays} days/year returned to strategy, growth, and life outside work`,9,'normal',[75,75,78]);
    doc.text(`${d.yearlyDays} days/year returned to strategy, growth, and life outside work`,pw/2,y+28,{align:'center'});

    txt('Industry benchmarks for distributors implementing automation:',8,'normal',[100,100,100]);
    doc.text('Industry benchmarks for distributors implementing automation:',pw/2,y+38,{align:'center'});
    txt('30-50% less time on operations | 2-4x faster decision-making | 20-40% fewer errors',8,'bold',[82,82,85]);
    doc.text('30-50% less time on operations | 2-4x faster decision-making | 20-40% fewer errors',pw/2,y+45,{align:'center'});
    y += 60;

    // ---- LIFE RECLAIMED ----
    cp(45);
    doc.setFillColor(228,240,228);
    doc.roundedRect(m,y,cw,35,3,3,'F');
    doc.setDrawColor(34,197,94);
    doc.roundedRect(m,y,cw,35,3,3,'S');
    txt('WHAT YOU GET BACK',12,'bold',[34,197,94]);
    doc.text('WHAT YOU GET BACK',pw/2,y+10,{align:'center'});
    txt(`${d.yearlyDays} workdays | ${d.dinners} family dinners | ${d.vacWeeks} weeks of vacation`,10,'bold',[50,80,50]);
    doc.text(`${d.yearlyDays} workdays | ${d.dinners} family dinners | ${d.vacWeeks} weeks of vacation`,pw/2,y+20,{align:'center'});
    txt('Time is the one resource you cannot manufacture. Every hour on automatable work is an hour stolen from growth and life.',8,'normal',[70,100,70]);
    doc.text('Time is the one resource you cannot manufacture. Every hour on automatable work is an hour stolen from growth and life.',pw/2,y+30,{align:'center'});
    y += 45;

    // ---- CTA ----
    cp(40);
    doc.setFillColor(30,30,42);
    doc.roundedRect(m,y,cw,35,3,3,'F');
    txt("LET'S GET YOUR TIME BACK",13,'bold',[255,255,255]);
    doc.text("LET'S GET YOUR TIME BACK",pw/2,y+11,{align:'center'});
    txt(`You now know exactly where ${d.automatableHrs.toFixed(0)} hours per week are going. Let's build the systems to recover them.`,9,'normal',[180,180,200]);
    const ctaLines = doc.splitTextToSize(`You now know exactly where ${d.automatableHrs.toFixed(0)} hours per week are going. Let's build the systems to recover them.`,cw-20);
    doc.text(ctaLines,pw/2,y+20,{align:'center'});
    txt('mo@deeplineop.ai',12,'bold',[245,200,80]);
    doc.text('mo@deeplineop.ai',pw/2,y+30,{align:'center'});

    // Footer on every page
    const pc = doc.internal.getNumberOfPages();
    for(let i=1;i<=pc;i++){
        doc.setPage(i);
        doc.setFillColor(30,30,42);
        doc.rect(0,287,pw,10,'F');
        txt('Mo Roowala | Deep Line Operations | AI Automation for Distributors',7,'normal',[130,130,150]);
        doc.text('Mo Roowala | Deep Line Operations | AI Automation for Distributors',pw/2,292,{align:'center'});
    }
    doc.save('CEO-Time-Audit-Report.pdf');
}
init();
</script>
</body>
</html>
