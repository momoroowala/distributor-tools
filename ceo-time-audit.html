<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEO Time Audit | What's Eating Your Week?</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        :root{--bg:#0a0a0f;--card:#12121a;--cell:#1a1a25;--border:#2a2a3a;--text:#f1f5f9;--muted:#94a3b8;--dim:#64748b}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;line-height:1.5}
        .container{max-width:960px;margin:0 auto;padding:1.5rem}
        header{text-align:center;margin-bottom:1.5rem;padding-top:1rem}
        .badge{display:inline-block;background:#f59e0b;color:#000;padding:0.2rem 0.6rem;border-radius:9999px;font-size:0.7rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;margin-bottom:0.75rem}
        h1{font-size:2rem;font-weight:700;margin-bottom:0.5rem;background:linear-gradient(135deg,var(--text),#f59e0b);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .subtitle{color:var(--muted);font-size:1rem;max-width:500px;margin:0 auto}
        .section{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:1.5rem;margin-bottom:1.5rem}
        .section h2{font-size:1.1rem;margin-bottom:0.25rem}
        .section .hint{font-size:0.8rem;color:var(--dim);margin-bottom:1rem}
        /* Palette */
        .palette{display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem}
        .palette-item{display:flex;align-items:center;gap:0.4rem;padding:0.4rem 0.75rem;border-radius:0.5rem;cursor:pointer;border:2px solid transparent;font-size:0.75rem;font-weight:600;transition:all 0.15s;user-select:none}
        .palette-item:hover{transform:scale(1.03)}
        .palette-item.active{border-color:#fff;box-shadow:0 0 10px rgba(255,255,255,0.2)}
        .palette-item .dot{width:10px;height:10px;border-radius:3px;flex-shrink:0}
        /* Calendar Grid */
        .cal-wrapper{overflow-x:auto;margin-bottom:1rem}
        .cal{display:grid;grid-template-columns:60px repeat(5,1fr);gap:1px;background:var(--border);border-radius:0.5rem;overflow:hidden;user-select:none}
        .cal-header{background:#1e1e2e;padding:0.5rem;text-align:center;font-size:0.75rem;font-weight:600;color:var(--muted)}
        .cal-time{background:#1e1e2e;padding:0.35rem 0.5rem;font-size:0.7rem;color:var(--dim);display:flex;align-items:center}
        .cal-cell{background:var(--cell);padding:0.3rem;min-height:28px;cursor:pointer;transition:background 0.1s;position:relative;display:flex;align-items:center;justify-content:center;font-size:0.6rem;font-weight:600;color:rgba(255,255,255,0.8)}
        .cal-cell:hover{filter:brightness(1.3)}
        /* Stats Bar */
        .stats-bar{display:flex;gap:1rem;flex-wrap:wrap;margin-top:1rem}
        .stat{flex:1;min-width:120px;background:var(--cell);border-radius:0.5rem;padding:0.75rem;text-align:center}
        .stat .num{font-size:1.4rem;font-weight:700}
        .stat .label{font-size:0.7rem;color:var(--dim)}
        .time-bar{height:24px;border-radius:0.25rem;overflow:hidden;display:flex;margin-top:1rem}
        .time-bar .seg{display:flex;align-items:center;justify-content:center;font-size:0.65rem;font-weight:600;color:#fff;transition:width 0.3s}
        /* Ad Hoc Section */
        .adhoc-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:0.75rem}
        .adhoc-item{background:var(--cell);border-radius:0.5rem;padding:0.75rem}
        .adhoc-item label{display:block;font-size:0.85rem;margin-bottom:0.25rem}
        .adhoc-item .hint{font-size:0.7rem;color:var(--dim);margin-bottom:0.4rem}
        .adhoc-item input{width:100%;padding:0.5rem;background:var(--bg);border:1px solid var(--border);border-radius:0.35rem;color:var(--text);font-size:0.9rem}
        .adhoc-item input:focus{outline:none;border-color:#f59e0b}
        .btn{width:100%;padding:0.9rem;border-radius:0.5rem;font-weight:600;font-size:1rem;cursor:pointer;border:none;margin-top:1rem;transition:all 0.2s}
        .btn-primary{background:#f59e0b;color:#000}
        .btn-primary:hover{background:#fbbf24}
        /* Results */
        .results-page{display:none}.results-page.active{display:block;animation:fadeIn 0.4s ease}
        @keyframes fadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
        .impact-card{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:2rem;text-align:center;margin-bottom:1.5rem}
        .impact-number{font-size:3rem;font-weight:700;line-height:1}
        .impact-label{color:var(--dim);font-size:0.9rem;margin-top:0.25rem}
        .impact-context{color:var(--muted);margin-top:0.75rem;font-size:0.9rem}
        .reclaim-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:0.75rem;margin-top:1.25rem}
        .reclaim-item{background:var(--cell);border-radius:0.5rem;padding:1rem;text-align:center}
        .reclaim-item .number{font-size:1.3rem;font-weight:700;color:#22c55e}
        .reclaim-item .desc{font-size:0.7rem;color:var(--dim);margin-top:0.2rem}
        .before-after{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:1.5rem;margin-bottom:1.5rem}
        .before-after h3{font-size:1rem;margin-bottom:1rem}
        .ba-row{display:flex;gap:1rem}
        .ba-col{flex:1;background:var(--cell);border-radius:0.75rem;padding:1rem}
        .ba-col h4{font-size:0.8rem;text-transform:uppercase;letter-spacing:0.05em;margin-bottom:0.5rem}
        .ba-col.before h4{color:#ef4444}.ba-col.after h4{color:#22c55e}
        .ba-stat{display:flex;justify-content:space-between;padding:0.3rem 0;font-size:0.8rem;border-bottom:1px solid var(--border)}
        .ba-stat:last-child{border-bottom:none}
        .ba-stat .val{font-weight:600}
        .download-section{background:linear-gradient(135deg,rgba(245,158,11,0.1),var(--card));border:2px solid #f59e0b;border-radius:1rem;padding:2rem;text-align:center;margin-bottom:1.5rem}
        .download-section h3{font-size:1.3rem;margin-bottom:0.4rem}
        .download-section>p{color:var(--muted);margin-bottom:1.25rem;font-size:0.9rem}
        .email-form{display:flex;gap:0.75rem;max-width:420px;margin:0 auto;flex-wrap:wrap}
        .email-form input[type="email"]{flex:1;min-width:200px;padding:0.75rem;background:var(--bg);border:1px solid var(--border);border-radius:0.5rem;color:var(--text);font-size:0.95rem}
        .email-form input:focus{outline:none;border-color:#f59e0b}
        .email-form .btn{width:auto;min-width:160px;margin-top:0}
        .download-complete{display:none;color:#22c55e;padding:0.75rem;font-size:0.95rem}
        .download-complete.active{display:block}
        footer{text-align:center;padding:1.5rem;color:var(--dim);font-size:0.8rem}
        footer a{color:#f59e0b;text-decoration:none}
        @media(max-width:700px){.container{padding:1rem}h1{font-size:1.5rem}.reclaim-grid{grid-template-columns:repeat(2,1fr)}.adhoc-grid{grid-template-columns:1fr}.ba-row{flex-direction:column}.cal{font-size:0.6rem}}
    </style>
</head>
<body>
<div class="container">
    <header>
        <span class="badge">Free Tool</span>
        <h1>What's Eating Your Week?</h1>
        <p class="subtitle">Paint your actual calendar. See what a machine should be doing instead of you.</p>
    </header>

    <div id="inputPage">
        <div class="section">
            <h2>Step 1: Paint Your Typical Week</h2>
            <p class="hint">Select a category below, then click or drag on the calendar to fill in your schedule. 9 AM to 9 PM, Monday through Friday.</p>

            <div class="palette" id="palette"></div>

            <div class="cal-wrapper">
                <div class="cal" id="calendar"></div>
            </div>

            <div class="time-bar" id="liveBar"></div>
            <div class="stats-bar" id="liveStats"></div>
        </div>

        <div class="section">
            <h2>Step 2: What Else Eats Your Time?</h2>
            <p class="hint">These tasks don't always show on a calendar but consume real hours every week.</p>
            <div class="adhoc-grid">
                <div class="adhoc-item"><label>Evening email/texts (after 9 PM)</label><div class="hint">Checking phone, responding to messages</div><input type="number" id="adhoc_evening" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
                <div class="adhoc-item"><label>Weekend work</label><div class="hint">Catching up, checking in, emergencies</div><input type="number" id="adhoc_weekend" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
                <div class="adhoc-item"><label>Unplanned interruptions</label><div class="hint">Walk-ins, surprise calls, "got a minute?"</div><input type="number" id="adhoc_interruptions" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
                <div class="adhoc-item"><label>Worrying/thinking about work</label><div class="hint">Laying in bed thinking about problems</div><input type="number" id="adhoc_worry" min="0" max="20" step="0.5" value="0" oninput="updateStats()"></div>
            </div>
        </div>

        <button class="btn btn-primary" onclick="analyze()">üîç Analyze My Week</button>
    </div>

    <div class="results-page" id="resultsPage">
        <div class="impact-card">
            <div class="impact-number" style="color:#ef4444" id="automatableHours">0</div>
            <div class="impact-label">hours per week you spend on tasks a machine could handle</div>
            <div class="impact-context" id="impactContext"></div>
        </div>

        <div class="impact-card" style="border-color:#22c55e">
            <div class="impact-number" style="color:#22c55e" id="reclaimedDays">0</div>
            <div class="impact-label">days per year you could reclaim</div>
            <div class="reclaim-grid" id="reclaimGrid"></div>
        </div>

        <div class="before-after">
            <h3>Your Week: Before vs After Automation</h3>
            <div class="ba-row">
                <div class="ba-col before" id="beforeCol"><h4>üî¥ Now</h4></div>
                <div class="ba-col after" id="afterCol"><h4>üü¢ After</h4></div>
            </div>
        </div>

        <div class="download-section">
            <h3>üìÑ Get Your Time Recovery Plan</h3>
            <p>Detailed PDF with automation recommendations for each time-waster and your "life reclaimed" projection.</p>
            <form class="email-form" id="emailForm" onsubmit="handleDownload(event)">
                <input type="email" id="userEmail" placeholder="Work email" required>
                <button type="submit" class="btn btn-primary">üì• Download PDF</button>
            </form>
            <div class="download-complete" id="downloadComplete">‚úì Report downloaded!</div>
        </div>
    </div>
    <footer><p>Built by <a href="#">Mo Roowala</a> | AI Automation for Distributors</p></footer>
</div>
<script>
const { jsPDF } = window.jspdf;

const categories = [
    { id:'strategy', name:'Strategy & Growth', short:'Strategy', color:'#22c55e', type:'strategic', save:0 },
    { id:'customers', name:'Customer Calls/Meetings', short:'Customers', color:'#06b6d4', type:'strategic', save:0 },
    { id:'pricing', name:'Pricing & Quotes', short:'Pricing', color:'#ef4444', type:'automatable', save:0.75 },
    { id:'orders', name:'Order Issues', short:'Orders', color:'#f97316', type:'automatable', save:0.65 },
    { id:'inventory', name:'Inventory/Purchasing', short:'Inventory', color:'#f43f5e', type:'automatable', save:0.6 },
    { id:'reports', name:'Reports & Data', short:'Reports', color:'#e11d48', type:'automatable', save:0.8 },
    { id:'admin', name:'Admin & Paperwork', short:'Admin', color:'#dc2626', type:'automatable', save:0.7 },
    { id:'fires', name:'Putting Out Fires', short:'Fires', color:'#b91c1c', type:'automatable', save:0.45 },
    { id:'email', name:'Email & Comms', short:'Email', color:'#eab308', type:'delegatable', save:0.35 },
    { id:'meetings', name:'Internal Meetings', short:'Meetings', color:'#a3a3a3', type:'delegatable', save:0.25 },
    { id:'people', name:'People Management', short:'People', color:'#8b5cf6', type:'delegatable', save:0.15 },
    { id:'break', name:'Break / Personal', short:'Break', color:'#374151', type:'neutral', save:0 }
];

const days = ['Mon','Tue','Wed','Thu','Fri'];
const hours = [];
for(let h=9;h<=20;h++) hours.push(h<12?h+'am':h===12?'12pm':(h-12)+'pm');

let selectedCat = 0;
let grid = {}; // key: "day-hour" -> categoryIndex
let isDragging = false;

function init() {
    // Palette
    const pal = document.getElementById('palette');
    pal.innerHTML = categories.map((c,i) => `
        <div class="palette-item ${i===0?'active':''}" onclick="selectCat(${i})" id="pal_${i}" style="background:${c.color}22">
            <div class="dot" style="background:${c.color}"></div>
            <span>${c.name}</span>
        </div>
    `).join('');

    // Calendar
    const cal = document.getElementById('calendar');
    let html = '<div class="cal-header"></div>';
    days.forEach(d => html += `<div class="cal-header">${d}</div>`);

    hours.forEach((h,hi) => {
        html += `<div class="cal-time">${h}</div>`;
        days.forEach((d,di) => {
            const key = `${di}-${hi}`;
            html += `<div class="cal-cell" id="c_${key}" data-key="${key}" 
                onmousedown="startPaint('${key}')" 
                onmouseenter="paint('${key}')"
                ontouchstart="startPaint('${key}')"
                ontouchmove="touchPaint(event)"></div>`;
        });
    });
    cal.innerHTML = html;
    document.addEventListener('mouseup', () => isDragging = false);
    document.addEventListener('touchend', () => isDragging = false);
    updateStats();
}

function selectCat(i) {
    selectedCat = i;
    document.querySelectorAll('.palette-item').forEach(p => p.classList.remove('active'));
    document.getElementById('pal_'+i).classList.add('active');
}

function startPaint(key) {
    isDragging = true;
    toggleCell(key);
}

function paint(key) {
    if(isDragging) toggleCell(key);
}

function touchPaint(e) {
    if(!isDragging) return;
    e.preventDefault();
    const touch = e.touches[0];
    const el = document.elementFromPoint(touch.clientX, touch.clientY);
    if(el && el.dataset && el.dataset.key) toggleCell(el.dataset.key);
}

function toggleCell(key) {
    const cell = document.getElementById('c_'+key);
    if(!cell) return;
    const cat = categories[selectedCat];
    if(grid[key] === selectedCat) {
        delete grid[key];
        cell.style.background = '';
        cell.textContent = '';
    } else {
        grid[key] = selectedCat;
        cell.style.background = cat.color + 'cc';
        cell.textContent = cat.short;
    }
    updateStats();
}

function updateStats() {
    const counts = {};
    categories.forEach((c,i) => counts[i] = 0);
    Object.values(grid).forEach(ci => counts[ci]++);

    const adhocEvening = parseFloat(document.getElementById('adhoc_evening')?.value) || 0;
    const adhocWeekend = parseFloat(document.getElementById('adhoc_weekend')?.value) || 0;
    const adhocInterruptions = parseFloat(document.getElementById('adhoc_interruptions')?.value) || 0;
    const adhocWorry = parseFloat(document.getElementById('adhoc_worry')?.value) || 0;
    const adhocTotal = adhocEvening + adhocWeekend + adhocInterruptions + adhocWorry;

    let strategic=0, delegatable=0, automatable=0, neutral=0;
    categories.forEach((c,i) => {
        if(c.type==='strategic') strategic += counts[i];
        else if(c.type==='delegatable') delegatable += counts[i];
        else if(c.type==='automatable') automatable += counts[i];
        else neutral += counts[i];
    });

    // Ad-hoc is mostly automatable/delegatable
    automatable += adhocInterruptions * 0.5;
    delegatable += adhocEvening + adhocWeekend + adhocInterruptions * 0.5 + adhocWorry;

    const total = strategic + delegatable + automatable + neutral + adhocTotal;

    // Live bar
    const bar = document.getElementById('liveBar');
    if(total > 0) {
        bar.innerHTML = `
            <div class="seg" style="width:${strategic/total*100}%;background:#22c55e">${strategic>0?strategic+'h':''}</div>
            <div class="seg" style="width:${delegatable/total*100}%;background:#eab308">${delegatable>0?Math.round(delegatable)+'h':''}</div>
            <div class="seg" style="width:${automatable/total*100}%;background:#ef4444">${automatable>0?Math.round(automatable)+'h':''}</div>
            <div class="seg" style="width:${neutral/total*100}%;background:#374151">${neutral>0?neutral+'h':''}</div>
        `;
    }

    // Live stats
    const calHours = Object.keys(grid).length;
    document.getElementById('liveStats').innerHTML = `
        <div class="stat"><div class="num">${calHours + adhocTotal}</div><div class="label">Total Hours</div></div>
        <div class="stat"><div class="num" style="color:#22c55e">${strategic}</div><div class="label">Strategic</div></div>
        <div class="stat"><div class="num" style="color:#eab308">${Math.round(delegatable)}</div><div class="label">Delegatable</div></div>
        <div class="stat"><div class="num" style="color:#ef4444">${Math.round(automatable)}</div><div class="label">Automatable</div></div>
    `;
}

function analyze() {
    const calHours = Object.keys(grid).length;
    const adhocEvening = parseFloat(document.getElementById('adhoc_evening').value) || 0;
    const adhocWeekend = parseFloat(document.getElementById('adhoc_weekend').value) || 0;
    const adhocInterruptions = parseFloat(document.getElementById('adhoc_interruptions').value) || 0;
    const adhocWorry = parseFloat(document.getElementById('adhoc_worry').value) || 0;

    if(calHours < 10) { alert('Please fill in more of your calendar (at least 10 hours).'); return; }

    // Count hours per category
    const catHours = {};
    categories.forEach((c,i) => catHours[i] = 0);
    Object.values(grid).forEach(ci => catHours[ci]++);

    // Build task breakdown
    let totalHrs = 0;
    let automatableHrs = 0;
    const breakdown = [];

    categories.forEach((c,i) => {
        let hrs = catHours[i] || 0;
        if(hrs === 0) return;
        const saved = hrs * c.save;
        automatableHrs += saved;
        totalHrs += hrs;
        breakdown.push({ ...c, hours: hrs, saved });
    });

    // Add ad hoc
    const adhocs = [
        { name:'Evening email/texts', hours:adhocEvening, save:0.6, type:'delegatable' },
        { name:'Weekend work', hours:adhocWeekend, save:0.4, type:'delegatable' },
        { name:'Unplanned interruptions', hours:adhocInterruptions, save:0.4, type:'automatable' },
        { name:'Worrying about work', hours:adhocWorry, save:0.3, type:'automatable' }
    ];
    adhocs.forEach(a => {
        if(a.hours > 0) {
            automatableHrs += a.hours * a.save;
            totalHrs += a.hours;
            breakdown.push({ name:a.name, hours:a.hours, saved:a.hours*a.save, type:a.type, color:'#6b7280' });
        }
    });

    // Show results
    document.getElementById('inputPage').style.display = 'none';
    document.getElementById('resultsPage').classList.add('active');

    document.getElementById('automatableHours').textContent = automatableHrs.toFixed(1);
    const yearlyHrs = Math.round(automatableHrs * 52);
    const yearlyDays = Math.round(yearlyHrs / 8);
    document.getElementById('reclaimedDays').textContent = yearlyDays;

    const pctAutomate = ((automatableHrs / totalHrs) * 100).toFixed(0);
    document.getElementById('impactContext').innerHTML = `<strong>${pctAutomate}%</strong> of your ${totalHrs}-hour work week is spent on tasks that don't need you. That's <strong>${yearlyHrs.toLocaleString()} hours per year</strong>.`;

    const dinners = Math.round(yearlyHrs / 2.5);
    const vacWeeks = (yearlyDays / 5).toFixed(1);
    const events = Math.round(yearlyHrs / 2);
    document.getElementById('reclaimGrid').innerHTML = `
        <div class="reclaim-item"><div class="number">${dinners}</div><div class="desc">Family dinners</div></div>
        <div class="reclaim-item"><div class="number">${vacWeeks}</div><div class="desc">Weeks of vacation</div></div>
        <div class="reclaim-item"><div class="number">${events}</div><div class="desc">Kids' events</div></div>
        <div class="reclaim-item"><div class="number">${yearlyHrs.toLocaleString()}</div><div class="desc">Hours for growth</div></div>
    `;

    // Before/After
    const bCol = document.getElementById('beforeCol');
    const aCol = document.getElementById('afterCol');
    bCol.innerHTML = '<h4>üî¥ Now</h4>';
    aCol.innerHTML = '<h4>üü¢ After</h4>';
    breakdown.sort((a,b) => b.hours - a.hours).forEach(t => {
        bCol.innerHTML += `<div class="ba-stat"><span>${t.name}</span><span class="val">${t.hours}h</span></div>`;
        const after = (t.hours - t.saved).toFixed(1);
        aCol.innerHTML += `<div class="ba-stat"><span>${t.name}</span><span class="val" style="color:${t.saved>0?'#22c55e':'inherit'}">${after}h</span></div>`;
    });
    bCol.innerHTML += `<div class="ba-stat" style="border-top:2px solid var(--border);margin-top:0.4rem;padding-top:0.4rem"><span><strong>Total</strong></span><span class="val">${totalHrs}h</span></div>`;
    aCol.innerHTML += `<div class="ba-stat" style="border-top:2px solid var(--border);margin-top:0.4rem;padding-top:0.4rem"><span><strong>Total</strong></span><span class="val" style="color:#22c55e">${(totalHrs - automatableHrs).toFixed(1)}h</span></div>`;

    window._data = { totalHrs, automatableHrs, yearlyHrs, yearlyDays, breakdown, dinners, vacWeeks, events };
}

function handleDownload(e) {
    e.preventDefault();
    const email = document.getElementById('userEmail').value;
    const leads = JSON.parse(localStorage.getItem('timeaudit_leads') || '[]');
    leads.push({ email, timestamp: new Date().toISOString(), data: window._data });
    localStorage.setItem('timeaudit_leads', JSON.stringify(leads));
    generatePDF(email);
    document.getElementById('emailForm').style.display = 'none';
    document.getElementById('downloadComplete').classList.add('active');
}

function generatePDF(email) {
    const d = window._data;
    const doc = new jsPDF();
    const pw = doc.internal.pageSize.getWidth();
    const ph = doc.internal.pageSize.getHeight();
    const m = 16, cw = pw - 2*m;
    let y = 0;
    let pageNum = 0;

    // Design system
    const C = {
        bg: [218,215,210], card: [240,238,235], cardAlt: [232,230,226],
        dark: [32,34,44], darkSoft: [48,50,58],
        text: [45,45,50], textMid: [75,75,80], textLight: [100,100,105], textMuted: [130,130,135],
        white: [255,255,255], shadow: [195,192,188],
        amber: [210,145,30], amberDark: [180,120,15], amberBg: [230,224,212],
        red: [200,58,48], green: [35,160,88], blue: [50,115,210], purple: [125,80,200]
    };

    const txt = (t,sz,st='normal',c=C.text) => { doc.setFontSize(sz); doc.setFont('helvetica',st); doc.setTextColor(...c); };
    const fill = (c) => doc.setFillColor(...c);
    const cp = (n=25) => { if(y+n>262){newPage(); return true;} return false; };

    const newPage = () => {
        doc.addPage(); pageNum++;
        fill(C.bg); doc.rect(0,0,pw,ph,'F');
        fill(C.amber); doc.rect(0,0,pw,1.2,'F');
        // Page side accent
        fill([225,222,218]); doc.rect(0,0,6,ph,'F');
        fill(C.amber); doc.rect(5,20,1,30,'F');
        y = 16;
    };

    // Card with shadow
    const card = (x,yc,w,h,opts={}) => {
        const r = opts.radius || 2.5;
        fill(C.shadow); doc.roundedRect(x+1,yc+1,w,h,r,r,'F');
        fill(opts.bg || C.card); doc.roundedRect(x,yc,w,h,r,r,'F');
        if(opts.accent) { fill(opts.accent); doc.roundedRect(x,yc,3.5,h,r,0,'F'); doc.rect(x+1.5,yc,2,h,'F'); }
    };

    // Section title with accent
    const secTitle = (title,yy,color=C.amber) => {
        fill(color); doc.roundedRect(m,yy,3,10,1,1,'F');
        txt(title,11,'bold',C.text); doc.text(title,m+8,yy+7);
        doc.setDrawColor(...C.shadow); doc.setLineWidth(0.3); doc.line(m+8,yy+10,pw-m,yy+10);
        return yy+14;
    };

    const totalHrs = d.breakdown.reduce((s,t) => s+t.hours,0);
    const strategicHrs = d.breakdown.filter(t=>t.type==='strategic').reduce((s,t)=>s+t.hours,0);
    const strategicPct = totalHrs > 0 ? Math.round((strategicHrs/totalHrs)*100) : 0;
    const afterTotal = totalHrs - d.automatableHrs;
    const sorted = [...d.breakdown].filter(t=>t.hours>0).sort((a,b)=>b.saved-a.saved);
    const maxHrs = Math.max(...sorted.map(t=>t.hours));

    // ================================================================
    // PAGE 1: COVER
    // ================================================================
    fill(C.bg); doc.rect(0,0,pw,ph,'F');

    // Full-width dark hero
    fill(C.dark); doc.rect(0,0,pw,78,'F');
    fill(C.amber); doc.rect(0,76.5,pw,1.5,'F');

    // Monogram circle
    fill(C.amber); doc.circle(pw/2,18,7,'F');
    txt('A',10,'bold',C.dark); doc.text('A',pw/2,21,{align:'center'});

    txt('CEO TIME AUDIT',20,'bold',C.white); doc.text('CEO TIME AUDIT',pw/2,40,{align:'center'});
    txt('Your Personalized Time Recovery Analysis',9,'normal',[170,170,185]); doc.text('Your Personalized Time Recovery Analysis',pw/2,49,{align:'center'});

    // Email + date in pill
    fill(C.darkSoft); doc.roundedRect(pw/2-45,56,90,9,4,4,'F');
    txt(new Date().toLocaleDateString('en-US',{month:'long',day:'numeric',year:'numeric'}),7,'normal',[155,155,170]);
    doc.text(new Date().toLocaleDateString('en-US',{month:'long',day:'numeric',year:'numeric'}),pw/2,62,{align:'center'});

    y = 88;

    // ---- 3-COLUMN KEY METRICS ----
    const metricW = (cw - 8) / 3;
    const mets = [
        { val: d.automatableHrs.toFixed(1), unit:'h/wk', label:'RECOVERABLE TIME', color: C.red },
        { val: d.yearlyDays.toString(), unit:' days', label:'DAYS PER YEAR', color: C.amber },
        { val: d.dinners.toString(), unit:'', label:'FAMILY DINNERS', color: C.green }
    ];
    mets.forEach((mt,i) => {
        const x = m + i*(metricW + 4);
        card(x,y,metricW,34,{accent:mt.color});
        txt(mt.val + mt.unit,16,'bold',mt.color); doc.text(mt.val + mt.unit,x+metricW/2+2,y+15,{align:'center'});
        txt(mt.label,6.5,'bold',C.textMid); doc.text(mt.label,x+metricW/2+2,y+23,{align:'center'});
        txt(mt === mets[0] ? 'tasks a machine could do' : mt === mets[1] ? 'returned to your life' : "you're missing annually",6,'normal',C.textLight);
        doc.text(mt === mets[0] ? 'tasks a machine could do' : mt === mets[1] ? 'returned to your life' : "you're missing annually",x+metricW/2+2,y+29,{align:'center'});
    });
    y += 44;

    // ---- EXECUTIVE SUMMARY ----
    card(m,y,cw,34,{accent:C.amber});
    txt('EXECUTIVE SUMMARY',7,'bold',C.amber); doc.text('EXECUTIVE SUMMARY',m+9,y+7);

    const sumLines = [
        `You reported ${totalHrs} hours/week across ${d.breakdown.filter(t=>t.hours>0).length} task categories.`,
        `${d.automatableHrs.toFixed(1)} hours/week (${Math.round(d.automatableHrs/totalHrs*100)}%) can be automated or delegated. Only ${strategicPct}% goes to strategic work.`,
        `Annual impact: ${d.yearlyDays} workdays, ${d.dinners} family dinners, ${d.vacWeeks} weeks of vacation lost to tasks that don't need you.`
    ];
    let sumY = y + 13;
    sumLines.forEach((sl,i) => {
        const st = i===1 ? 'bold' : 'normal';
        const col = i===2 ? C.amber : C.text;
        txt(sl,8,st,col);
        const lines = doc.splitTextToSize(sl,cw-16);
        doc.text(lines,m+9,sumY);
        sumY += lines.length * 4 + 2;
    });
    y += 42;

    // ---- TIME BREAKDOWN CHART ----
    y = secTitle('WHERE YOUR TIME GOES', y);

    card(m,y,cw, sorted.length*11 + 14);
    let bY = y + 10;

    sorted.forEach(t => {
        const typeColors = { strategic:C.green, delegatable:C.amber, automatable:C.red };
        const col = typeColors[t.type] || C.textLight;

        // Colored dot
        fill(col); doc.circle(m+8,bY+1,1.8,'F');

        // Name
        txt(t.name,7.5,'bold',C.text); doc.text(t.name,m+14,bY+2.5);

        // Bar
        const barX = m + 62, barW = cw - 80;
        const curW = Math.max((t.hours/maxHrs)*barW, 2);
        const aftW = Math.max(((t.hours-t.saved)/maxHrs)*barW, 0.5);

        fill(C.cardAlt); doc.roundedRect(barX,bY-1.5,curW,4.5,1.5,1.5,'F');
        fill(col); doc.roundedRect(barX,bY-1.5,aftW,4.5,1.5,1.5,'F');

        txt(`${t.hours}h`,6.5,'bold',C.textMid); doc.text(`${t.hours}h`,barX+curW+3,bY+2);
        if(t.saved>0){ txt(`-${t.saved.toFixed(1)}h`,6,'bold',C.red); doc.text(`-${t.saved.toFixed(1)}h`,pw-m-6,bY+2,{align:'right'}); }
        bY += 11;
    });
    y = bY + 6;

    // ---- CATEGORY SPLIT + BEFORE/AFTER (side by side) ----
    cp(55);
    const halfW = (cw-6)/2;

    // Left card: Category split
    card(m,y,halfW,48);
    txt('BY TYPE',7,'bold',C.amber); doc.text('BY TYPE',m+8,y+9);
    const cats = [
        { label:'Strategic (keep)', color:C.green, hrs: d.breakdown.filter(t=>t.type==='strategic').reduce((s,t)=>s+t.hours,0) },
        { label:'Delegatable', color:C.amber, hrs: d.breakdown.filter(t=>t.type==='delegatable').reduce((s,t)=>s+t.hours,0) },
        { label:'Automatable', color:C.red, hrs: d.breakdown.filter(t=>t.type==='automatable').reduce((s,t)=>s+t.hours,0) }
    ];
    let cY = y + 16;
    cats.forEach(c => {
        if(c.hrs<=0) return;
        const pct = Math.round((c.hrs/totalHrs)*100);
        const bw = (pct/100)*(halfW-30);
        fill(c.color); doc.roundedRect(m+8,cY,bw,6,2,2,'F');
        txt(`${c.label}: ${c.hrs}h (${pct}%)`,6.5,'normal',C.text); doc.text(`${c.label}: ${c.hrs}h (${pct}%)`,m+8,cY+12);
        cY += 16;
    });

    // Right card: Before/After visual
    const rx = m + halfW + 6;
    card(rx,y,halfW,48);
    txt('YOUR WEEK',7,'bold',C.blue); doc.text('YOUR WEEK',rx+8,y+9);

    // NOW circle
    fill(C.red); doc.circle(rx+halfW*0.28,y+30,10,'F');
    txt(totalHrs.toString(),12,'bold',C.white); doc.text(totalHrs.toString(),rx+halfW*0.28,y+33,{align:'center'});
    txt('hrs/now',5.5,'bold',C.red); doc.text('hrs/now',rx+halfW*0.28,y+42,{align:'center'});

    // Arrow
    fill(C.textMuted); 
    doc.triangle(rx+halfW*0.47,y+30, rx+halfW*0.42,y+27, rx+halfW*0.42,y+33, 'F');

    // AFTER circle
    fill(C.green); doc.circle(rx+halfW*0.68,y+30,10,'F');
    txt(afterTotal.toFixed(0),12,'bold',C.white); doc.text(afterTotal.toFixed(0),rx+halfW*0.68,y+33,{align:'center'});
    txt('hrs/after',5.5,'bold',C.green); doc.text('hrs/after',rx+halfW*0.68,y+42,{align:'center'});

    y += 58;

    // ================================================================
    // PAGE 2+: AUTOMATION PLAYBOOK
    // ================================================================
    newPage();
    
    // Section page header
    fill(C.dark); doc.roundedRect(m,y,cw,16,3,3,'F');
    fill(C.amber); doc.rect(m,y+14,cw,2,'F');
    txt('AUTOMATION PLAYBOOK',12,'bold',C.white); doc.text('AUTOMATION PLAYBOOK',pw/2,y+10,{align:'center'});
    y += 24;
    txt('Step-by-step plans for each area, prioritized by time savings',8,'normal',C.textLight);
    doc.text('Step-by-step plans for each area, prioritized by time savings',pw/2,y,{align:'center'});
    y += 10;

    const guides = {
        'Pricing & Quotes': {
            solution:'Rule-based pricing engine with automated approval workflows',
            impact:'Reduces quoting time by 60-80%. Eliminates margin erosion from inconsistent pricing.',
            quickWin:'Create templates for your top 5 most common quote types today. This alone saves 30-45 minutes per day.',
            steps:[
                'Week 1-2: Audit 90 days of quotes. Identify top 10 quote types and pricing patterns.',
                'Week 3-4: Create pricing matrix by customer tier (A/B/C) and product category.',
                'Week 5-6: Configure ERP with the matrix. Set auto-approval for quotes within defined ranges.',
                'Week 7-8: Train team. Role-play 20 common scenarios. Implement exception-only escalation.',
                'Month 3: Review override frequency. Target: 90% of quotes handled without you.'
            ]
        },
        'Order Issues': {
            solution:'Order validation engine with customer self-service portal',
            impact:'Reduces order errors by 70%+ and processing time by 50%. Frees you from being the order fixer.',
            quickWin:'Add a mandatory review-before-submit screen with order summary. Catches 40% of entry errors.',
            steps:[
                'Week 1-2: Track every order issue for 5 days. Categorize and find top 3 error patterns.',
                'Week 3-4: Build validation rules for each pattern. Flag quantity, price, and address anomalies.',
                'Week 5-6: Create customer portal for top 20 accounts (order, track, reorder).',
                'Week 7-8: Set up automated order confirmation emails with details and delivery dates.',
                'Month 3: Target fewer than 5% of orders needing your involvement.'
            ]
        },
        'Inventory/Purchasing': {
            solution:'Demand forecasting with automated reorder point management',
            impact:'Reduces stockouts by 50%+, cuts excess inventory 20-30%, frees working capital.',
            quickWin:'Set up reorder alerts for your top 20 SKUs by volume. Prevents the stockout calls.',
            steps:[
                'Week 1-2: Run ABC analysis. A=top 80% revenue, B=next 15%, C=bottom 5%.',
                'Week 3-4: Calculate and set reorder points for all A items in your ERP.',
                'Week 5-6: Identify dead stock (no movement 12+ months). Create liquidation plan.',
                'Week 7-8: Implement cycle counting: A monthly, B quarterly, C annually.',
                'Month 3: Track fill rate weekly. Target 95%+. Adjust safety stock as needed.'
            ]
        },
        'Reports & Data': {
            solution:'Automated dashboards replacing manual spreadsheet compilation',
            impact:'Eliminates 80-90% of manual reporting time. Gives team self-service data access.',
            quickWin:'Schedule your most-requested report to auto-generate and email every Monday morning.',
            steps:[
                'Week 1-2: List every report you create weekly. Note who needs it and build time.',
                'Week 3-4: Build automated versions of top 3 reports. Schedule auto-delivery.',
                'Week 5-6: Create real-time KPI dashboard (daily orders, revenue, margin, turns).',
                'Week 7-8: Train team to pull their own data. Create "how to find X" guides.',
                'Month 3: Eliminate all manual spreadsheet compilation.'
            ]
        },
        'Admin & Paperwork': {
            solution:'Digital workflows replacing paper-based approval processes',
            impact:'Cuts administrative overhead by 40-60%. Eliminates approval bottlenecks.',
            quickWin:'Delegate all approvals under $500 to your team lead. Saves 2-3 hours per week.',
            steps:[
                'Week 1-2: Map every approval chain. Set tiered authority (<$500, $500-$2K, >$2K).',
                'Week 3-4: Digitize top 5 paper forms (Google Forms, JotForm). Route automatically.',
                'Week 5-6: Implement e-signatures for routine documents. Stop printing, signing, scanning.',
                'Week 7-8: Automate invoice processing for recurring vendors with known pricing.',
                'Month 3: Only strategic or unusual approvals should reach you.'
            ]
        },
        'Putting Out Fires': {
            solution:'Proactive monitoring with early warning alerts and response playbooks',
            impact:'Reduces reactive firefighting by 60-80%. Prevents crises instead of responding.',
            quickWin:'Identify your #1 most frequent fire type. Write the playbook and hand it off today.',
            steps:[
                'Week 1-2: Log every fire for 5 days. Categorize by type, root cause, time spent.',
                'Week 3-4: Write one-page response playbooks for each recurring fire type.',
                'Week 5-6: Build automated alerts for conditions that precede fires.',
                'Week 7-8: Assign fire-fighting authority to specific team members.',
                'Month 3: Track fires per week. Target 50% reduction by fixing root causes.'
            ]
        },
        'Email & Comms': {
            solution:'Smart email management with templates, batching, and delegation',
            impact:'Reduces email time by 50-70%. Reclaims the most fragmented hours of your day.',
            quickWin:'Turn off email notifications. Check 3x daily. Recovers 1-2 hours of focused time.',
            steps:[
                'Week 1-2: Track email volume. Categorize: your decision, informational, team can handle.',
                'Week 3-4: Create canned responses for 15-20 most common email types.',
                'Week 5-6: Set up filters. Route operational emails to responsible team members.',
                'Week 7-8: Implement 3x daily batching. Delegate routine correspondence.',
                'Month 3: Target under 45 minutes total daily email time.'
            ]
        },
        'Internal Meetings': {
            solution:'Async-first communication with purpose-driven meeting structure',
            impact:'Recovers 30-50% of meeting time. Forces preparation, improves decisions.',
            quickWin:'Cancel your least valuable recurring meeting this week. If nobody complains, it was not needed.',
            steps:[
                'Week 1-2: Audit calendar. For each recurring meeting: what decisions get made?',
                'Week 3-4: Convert status meetings to async (dashboards, written summaries).',
                'Week 5-6: Enforce 25-min defaults, required agendas, no agenda = cancelled.',
                'Week 7-8: Batch remaining meetings into 2-3 days. Protect no-meeting days.',
                'Month 3: Target 50% reduction in meeting hours.'
            ]
        },
        'Customer Calls': {
            solution:'Tiered customer management with proactive communication systems',
            impact:'Reduces reactive calls by 40-60% while improving satisfaction.',
            quickWin:'Route all "where is my order?" calls to a team member with system access.',
            steps:[
                'Week 1-2: Categorize calls: order status, pricing, complaints, reorders, relationship.',
                'Week 3-4: Build self-service options (portal, tracking emails, FAQ).',
                'Week 5-6: Assign account managers to top 20 accounts with warm handoffs.',
                'Week 7-8: Set up proactive outbound (monthly check-ins, reorder reminders).',
                'Month 3: Only strategic conversations (renewals, expansions) reach you.'
            ]
        },
        'Strategy & Growth': {
            solution:'Protected strategic time with structured planning cadence',
            impact:'This is the category you should be INCREASING, not automating.',
            quickWin:'Block tomorrow morning 8-10am for strategic thinking. Protect it like a customer meeting.',
            steps:[
                'Week 1-2: Block 2 hours every morning for strategic work. No email, no calls.',
                'Week 3-4: Create a priorities list (max 3 goals per quarter). Review weekly.',
                'Week 5-6: Schedule monthly strategy sessions with key leaders.',
                'Week 7-8: Build a 90-day rolling plan: building, testing, measuring.',
                'Month 3: Target at least 30% of time on strategy. This is where growth lives.'
            ]
        },
        'People Management': {
            solution:'Systematized people management with clear processes and delegation',
            impact:'Reduces people-management overhead by 40% while building stronger culture.',
            quickWin:'Write answers to the 5 most common employee questions and share them.',
            steps:[
                'Week 1-2: Separate HR tasks only you can do from everything else. Delegate the rest.',
                'Week 3-4: Create an employee handbook for top 20 common questions.',
                'Week 5-6: Implement structured 15-min biweekly 1-on-1s (replace ad-hoc chats).',
                'Week 7-8: Set up performance review templates and self-assessments on a calendar.',
                'Month 3: Only strategic people decisions remain with you.'
            ]
        },
        'Other': {
            solution:'Audit and eliminate or delegate miscellaneous time drains',
            impact:'The "other" category often hides the biggest time sinks because they feel unavoidable.',
            quickWin:'Pick the most annoying "other" task and either delegate it or create a system for it.',
            steps:[
                'Week 1-2: Track what "other" actually means. Write down every task for 5 days.',
                'Week 3-4: For each: does this generate revenue? Prevent loss? Is it your job? If no: stop.',
                'Week 5-6: Delegate viable tasks with checklists. Automate repetitive ones.',
                'Week 7-8: Assign surviving tasks a proper home in someone\'s job description.',
                'Month 3: Target under 2 hours per week in "other."'
            ]
        },
        'Evening email/texts': {
            solution:'Boundary-setting with async communication expectations',
            impact:'Reclaims your evenings and improves sleep quality and morning focus.',
            quickWin:'Set a hard cutoff time. Communicate it to your team. Use "schedule send" for after-hours.',
            steps:[
                'Week 1-2: Track what evening messages are truly urgent vs. habitual.',
                'Week 3-4: Set up an on-call rotation for genuine emergencies.',
                'Week 5-6: Move all non-urgent communication to next-day morning batch.',
                'Week 7-8: Create an escalation path: text for emergencies only, email for everything else.',
                'Month 3: Target zero routine email after your cutoff time.'
            ]
        },
        'Weekend work': {
            solution:'Batch processing and Monday preparation system',
            impact:'Gives you real weekends. Prevents the Sunday dread cycle.',
            quickWin:'Block Friday 4-5pm as "Monday prep." Handle everything so weekends are clean.',
            steps:[
                'Week 1-2: Track what pulls you in on weekends. Separate urgent from self-imposed.',
                'Week 3-4: Create Friday end-of-week handoff (status, blockers, Monday priorities).',
                'Week 5-6: Assign weekend emergency coverage to a team member (rotate monthly).',
                'Week 7-8: Set a clear weekend policy and communicate it to customers and team.',
                'Month 3: Target zero non-emergency weekend work.'
            ]
        },
        'Unplanned interruptions': {
            solution:'Structured availability windows with buffer blocks',
            impact:'Eliminates context-switching cost (each interruption costs 23 minutes of refocus time).',
            quickWin:'Hang a "deep work in progress" sign during your morning strategic block.',
            steps:[
                'Week 1-2: Track every interruption: who, what, when, urgency. Find the pattern.',
                'Week 3-4: Create "office hours" for questions (e.g., 10-11am and 3-4pm). Redirect outside those.',
                'Week 5-6: Build an FAQ or decision guide for the top 5 interruption types.',
                'Week 7-8: Empower team to handle more decisions independently (see Decision Authority plan).',
                'Month 3: Target 70% reduction in unplanned interruptions.'
            ]
        },
        'Worrying about work': {
            solution:'Capture systems and structured weekly reviews',
            impact:'Reduces mental load and improves both sleep quality and strategic thinking.',
            quickWin:'Keep a notepad by your bed. When a work thought hits, write it and let go.',
            steps:[
                'Week 1-2: Implement a "capture" system (app or notebook). Every worry gets written down.',
                'Week 3-4: Schedule a weekly review (Friday afternoon). Process every captured item.',
                'Week 5-6: For each worry, ask: can I control this? If yes, make it a task. If no, let it go.',
                'Week 7-8: Build dashboards for your top worry areas. Visibility replaces anxiety.',
                'Month 3: Measure sleep quality and evening stress. Systems should replace worrying.'
            ]
        }
    };

    // Render each area as a visual card
    let areaIdx = 0;
    sorted.filter(t=>t.saved>=0.3).forEach(t => {
        const g = guides[t.name];
        if(!g) return;
        areaIdx++;

        // Estimate card height
        const estHeight = 85 + g.steps.length * 6;
        cp(Math.min(estHeight, 130));

        const typeColors = { strategic:C.green, delegatable:C.amber, automatable:C.red };
        const col = typeColors[t.type] || C.textLight;

        // Area header bar
        fill(col); doc.roundedRect(m,y,cw,10,2,2,'F');
        // Number badge
        fill(C.dark); doc.circle(m+8,y+5,4.5,'F');
        txt(areaIdx.toString(),8,'bold',C.white); doc.text(areaIdx.toString(),m+8,y+7.5,{align:'center'});
        txt(t.name.toUpperCase(),9,'bold',C.white); doc.text(t.name.toUpperCase(),m+17,y+7);
        txt(`SAVE ${t.saved.toFixed(1)}h/WEEK`,8,'bold',C.white); doc.text(`SAVE ${t.saved.toFixed(1)}h/WEEK`,pw-m-5,y+7,{align:'right'});
        y += 14;

        // Solution + Impact row (side by side if space)
        card(m,y,cw,20);
        txt('SOLUTION',6,'bold',col); doc.text('SOLUTION',m+6,y+6);
        txt(g.solution,7.5,'normal',C.text);
        const solL = doc.splitTextToSize(g.solution,cw-14);
        doc.text(solL,m+6,y+11);
        txt('Impact: '+g.impact,6.5,'italic',C.textMid);
        const impL = doc.splitTextToSize('Impact: '+g.impact,cw-14);
        doc.text(impL,m+6,y+11+solL.length*3.5);
        y += 12 + solL.length*3.5 + impL.length*3 + 4;

        // Quick Win box
        card(m,y,cw,14,{bg:C.amberBg, accent:C.amber});
        txt('QUICK WIN',6,'bold',C.amberDark); doc.text('QUICK WIN',m+8,y+5.5);
        txt(g.quickWin,7,'normal',C.text);
        const qwL = doc.splitTextToSize(g.quickWin,cw-16);
        doc.text(qwL,m+8,y+10);
        y += Math.max(14, qwL.length*3.5 + 12);

        // Action steps
        txt('ACTION STEPS',6.5,'bold',C.textMid); doc.text('ACTION STEPS',m+2,y+3);
        y += 7;

        g.steps.forEach((step,si) => {
            cp(12);
            // Step number circle
            fill(col); doc.circle(m+5,y+1,2.5,'F');
            txt((si+1).toString(),6,'bold',C.white); doc.text((si+1).toString(),m+5,y+2.8,{align:'center'});

            txt(step,7,'normal',C.text);
            const sL = doc.splitTextToSize(step,cw-16);
            doc.text(sL,m+12,y+2);
            y += sL.length*3.5 + 2.5;
        });
        y += 8;
    });

    // ================================================================
    // 90-DAY ROADMAP PAGE
    // ================================================================
    newPage();

    fill(C.dark); doc.roundedRect(m,y,cw,16,3,3,'F');
    fill(C.amber); doc.rect(m,y+14,cw,2,'F');
    txt('90-DAY TIME RECOVERY ROADMAP',12,'bold',C.white); doc.text('90-DAY TIME RECOVERY ROADMAP',pw/2,y+10,{align:'center'});
    y += 24;

    const topAreas = sorted.filter(t=>t.saved>=0.5).slice(0,4).map(t=>t.name);
    const phases = [
        { title:'DAYS 1-14: QUICK WINS', color:C.green, desc:'Low-effort changes this week.', items:[
            'Implement email batching (3x daily). Turn off notifications.',
            topAreas[0] ? `Create templates/playbooks for ${topAreas[0]}.` : 'Template your biggest time drain.',
            'Delegate all approvals under $500 to your team lead.',
            'Cancel or convert least valuable recurring meeting to async.',
            'Block 2 hours every morning for strategic work only.'
        ]},
        { title:'DAYS 15-30: FOUNDATIONS', color:C.amber, desc:'Build systems that replace you.', items:[
            topAreas[0] ? `Build full system for ${topAreas[0]}: rules, workflows, training.` : 'Systematize top time drain.',
            topAreas[1] ? `Start automation for ${topAreas[1]}.` : 'Automate second biggest drain.',
            'Set up dashboards to replace manual reporting.',
            'Create escalation matrix: Level 1 team, Level 2 manager, Level 3 you.'
        ]},
        { title:'DAYS 31-60: AUTOMATION', color:C.blue, desc:'Deploy technology and expand delegation.', items:[
            'Configure ERP automation for pricing, reorder, and order validation.',
            'Launch customer self-service (portal, tracking, FAQ).',
            'Implement proactive monitoring alerts to prevent fires.',
            'Expand team authority as trust builds from first 30 days.'
        ]},
        { title:'DAYS 61-90: OPTIMIZE', color:C.purple, desc:'Fine-tune and protect recovered time.', items:[
            'Review all KPIs: time per task, error rates, team confidence.',
            'Reallocate recovered time to strategy, growth, relationships.',
            `Target: ${d.automatableHrs.toFixed(0)}+ hours/week recovered.`,
            'Schedule quarterly time audit to prevent old habits returning.'
        ]}
    ];

    // Timeline visualization
    phases.forEach((phase,pi) => {
        cp(50);

        // Timeline dot and line
        const dotX = m + 6;
        fill(phase.color); doc.circle(dotX,y+5,3.5,'F');
        txt((pi+1).toString(),7,'bold',C.white); doc.text((pi+1).toString(),dotX,y+7,{align:'center'});
        if(pi < phases.length-1) {
            doc.setDrawColor(...C.shadow); doc.setLineWidth(0.8); doc.line(dotX,y+9,dotX,y+48);
        }

        // Phase card
        card(m+16,y,cw-16,0,{accent:phase.color}); // just for accent, real bg below

        // Phase header
        fill(phase.color); doc.roundedRect(m+16,y,cw-16,8,2,2,'F');
        txt(phase.title,8,'bold',C.white); doc.text(phase.title,m+22,y+6);
        txt(phase.desc,7,'italic',C.white); doc.text(phase.desc,pw-m-5,y+6,{align:'right'});
        y += 12;

        phase.items.forEach(item => {
            cp(10);
            fill(phase.color); doc.circle(m+20,y+1.5,1.2,'F');
            txt(item,7.5,'normal',C.text);
            const iL = doc.splitTextToSize(item,cw-30);
            doc.text(iL,m+25,y+2.5);
            y += iL.length*3.8 + 2;
        });
        y += 8;
    });

    // ================================================================
    // ROI + LIFE RECLAIMED + CTA
    // ================================================================
    cp(90);
    y = secTitle('RETURN ON INVESTMENT', y);

    // ROI metrics (2 column)
    const hourlyValue = 150;
    const weeklyValue = Math.round(d.automatableHrs * hourlyValue);
    const annualValue = weeklyValue * 50;

    const roiW = (cw-6)/2;
    card(m,y,roiW,30,{accent:C.amber});
    txt('VALUE OF YOUR TIME',6.5,'bold',C.amber); doc.text('VALUE OF YOUR TIME',m+9,y+8);
    txt(`$${annualValue.toLocaleString()}`,16,'bold',C.amber); doc.text(`$${annualValue.toLocaleString()}`,m+9,y+18);
    txt(`per year at $${hourlyValue}/hr CEO value`,7,'normal',C.textMid); doc.text(`per year at $${hourlyValue}/hr CEO value`,m+9,y+24);

    card(m+roiW+6,y,roiW,30,{accent:C.green});
    txt('LIFE RECLAIMED',6.5,'bold',C.green); doc.text('LIFE RECLAIMED',m+roiW+15,y+8);
    txt(`${d.yearlyDays} days`,16,'bold',C.green); doc.text(`${d.yearlyDays} days`,m+roiW+15,y+18);
    txt(`${d.dinners} dinners, ${d.vacWeeks} weeks vacation`,7,'normal',C.textMid); doc.text(`${d.dinners} dinners, ${d.vacWeeks} weeks vacation`,m+roiW+15,y+24);
    y += 38;

    // Industry benchmarks
    card(m,y,cw,20);
    txt('INDUSTRY BENCHMARKS',6.5,'bold',C.blue); doc.text('INDUSTRY BENCHMARKS',m+8,y+7);
    const benchmarks = ['30-50% less time on operations','2-4x faster decision-making','20-40% fewer errors','15-25% revenue growth from freed capacity'];
    benchmarks.forEach((b,i) => {
        const bx = m + 8 + i*(cw-16)/4;
        fill(C.blue); doc.circle(bx+2,y+13,1.2,'F');
        txt(b,5.5,'normal',C.text); 
        const bl = doc.splitTextToSize(b,(cw-16)/4-4);
        doc.text(bl,bx+6,y+14);
    });
    y += 26;

    // ---- CTA ----
    cp(40);
    fill(C.dark); doc.roundedRect(m,y,cw,36,3,3,'F');
    fill(C.amber); doc.rect(m,y+34,cw,2,'F');

    txt("LET'S GET YOUR TIME BACK",13,'bold',C.white); doc.text("LET'S GET YOUR TIME BACK",pw/2,y+12,{align:'center'});
    txt(`${d.automatableHrs.toFixed(0)} hours/week are going to tasks that don't need you. Let's build the systems to recover them.`,8,'normal',[175,175,190]);
    const ctaL = doc.splitTextToSize(`${d.automatableHrs.toFixed(0)} hours/week are going to tasks that don't need you. Let's build the systems to recover them.`,cw-30);
    doc.text(ctaL,pw/2,y+20,{align:'center'});
    txt('mo@deeplineop.ai',11,'bold',C.amberLight); doc.text('mo@deeplineop.ai',pw/2,y+30,{align:'center'});

    // ---- FOOTER ON ALL PAGES ----
    const pc = doc.internal.getNumberOfPages();
    for(let i=1;i<=pc;i++){
        doc.setPage(i);
        fill(C.dark); doc.rect(0,ph-8,pw,8,'F');
        fill(C.amber); doc.rect(0,ph-8,pw,0.5,'F');
        txt('Mo Roowala  |  Deep Line Operations  |  AI Automation for Distributors',6,'normal',[140,140,155]);
        doc.text('Mo Roowala  |  Deep Line Operations  |  AI Automation for Distributors',pw/2,ph-3,{align:'center'});
        txt(`Page ${i} of ${pc}`,5.5,'normal',[120,120,135]); doc.text(`Page ${i} of ${pc}`,pw-m,ph-3,{align:'right'});
    }

    doc.save('CEO-Time-Audit-Report.pdf');
}

init();
</script>
</body>
</html>
